<span id="upgtop"></span>

<h1>osCommerce Online Merchant v2.3.4 -DRAFT-</h1>

<p>osCommerce Online Merchant v2.3.4 is a general maintenance release focusing on improving core features and introduces a new Content Modules feature.</p>

<p>This release is based on v2.3.3.4, not on v2.3.3. It is therefore important to review the <a href="{link}Online|Library|en&oscom_2_3&release_notes{link}">v2.3.3.1 to v2.3.3.4 release notes</a> when upgrading from v2.3.3.</p>

<div class="visible-print">
  <p>This document can be found online at:</p>

  <p><a href="http://library.oscommerce.com/Online&amp;en&amp;oscom_2_3&amp;release_notes&amp;v2_3_4">http://library.oscommerce.com/Online&amp;en&amp;oscom_2_3&amp;release_notes&amp;v2_3_4</a></p>
</div>

<h2>Changelog <small>Changes from v2.3.3.4</small></h2>

<p>The following changes have been applied:</p>

<table class="table table-hover">
  <thead>
    <tr>
      <th>Title</th>
      <th>Description</th>
      <th>Bug</th>
      <th>Severity</th>
      <th>Developer</th>
    </tr>
  </thead>
  <tbody>
    <tr class="success">
      <td><a href="#upg1">jQuery UI</a> (2+ files)</td>
      <td>Update jQuery UI from 1.8.22 to 1.10.4.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg2">jQuery</a> (2+ files)</td>
      <td>Update jQuery from 1.8.0 to 1.11.0.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg3">Flot (jQuery Library)</a> (1+ files)</td>
      <td>Update Flot (jQuery Library) from 0.6 to 0.8.2.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg4">PhotosetGrid and ColorBox</a> (3+ files)</td>
      <td>Replace bxGallery and FancyBox with PhotosetGrid and Colorbox.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg5">Administration Tool Boxes</a> (1 file)</td>
      <td>Fix height of Administration Tool boxes.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg6">Improve $PHP_SELF</a> (11 files)</td>
      <td>Improve $PHP_SELF to work in subdirectories.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg7">Session Lifetime</a> (5 files + SQL)</td>
      <td>Change database session lifetime to match file session lifetime.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg8">Block Orders With No Shipping</a> (2 files + SQL)</td>
      <td>Block orders when no shipping modules are available for the destination.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg9">Product Attributes Administration</a> (1 file)</td>
      <td>Remove double query in product attributes administration.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=69" target="_blank">Gary</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg10">Remove Free Shipping Check On Non-Related Page</a> (1 file)</td>
      <td>Remove check on non-existing $free_shipping variable.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg11">Checkout Confirmation MessageStack</a> (1 file)</td>
      <td>Add message stack output to the checkout confirmation page.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg12">CA Public Certificate Bundle</a> (1 file)</td>
      <td>Add the CA public certificate bundle for curl to use on secure connections.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg13">Modules Administration</a> (1 file)</td>
      <td>Detect when modules have been removed without using the Administration Tool.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=145221" target="_blank">Scott</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg14">HTTPS Administration Tool</a> (22 files + Config)</td>
      <td>Force HTTPS on the Administration Tool if SSL is enabled.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg15">Content Modules</a> (6+ files)</td>
      <td>Introduce Content Modules for the Login, My Account, and Checkout Success pages.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg16">Version Update</a> (1 file)</td>
      <td>Update version to v2.3.4.</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr class="success">
      <td><a href="#upg17">Administration Dashboard Latest News and Add-Ons</a> (4+ files)</td>
      <td>Update the Administration Tool Dashboard Latest News and Latest Add-Ons modules.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=69" target="_blank">Gary</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg18">Administration Tool Orders Box</a> (3 files)</td>
      <td>Please Orders in own Administration Tool menu.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg19">Payment Acceptance Box</a> (2+ files)</td>
      <td>Introduce a new payment acceptance box.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg20">PayPal Modules</a> (23 files)</td>
      <td>
        Update the following modules:<br /><br />
        PayPal Express Checkout<br />
        PayPal Payments Standard<br />
        PayPal Payments Pro (Direct Payment)<br />
        PayPal Express Checkout (Payflow Edition)<br />
        PayPal Payments Pro (Payflow Edition)<br /><br />
        Introduce the following modules:<br /><br />
        PayPal Payments Pro (Hosted Solution)<br />
        Log In with PayPal
      </td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg21">Sage Pay Modules</a> (12 files)</td>
      <td>
        Update the following modules:<br /><br />
        Sage Pay Direct<br />
        Sage Pay Form<br />
        Sage Pay Server<br /><br />
        Introduce the following modules:<br /><br />
        Sage Pay Cards Management Page content module
      </td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg22">Authorize.net Modules</a> (7 files)</td>
      <td>
        Update the following modules:<br /><br />
        Authorize.net Server Integration Method (SIM)<br />
        Authorize.net Advanced Integration Method (AIM)<br /><br />
        Introduce the following modules:<br /><br />
        Authorize.net Direct Post Method (DPM)
      </td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg23">Stripe Modules</a> (5 files)</td>
      <td>
        Introduce the following modules:<br /><br />
        Stripe.js payment module<br />
        Stripe Cards Management Page content module
      </td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg24">Braintree Modules</a> (5+ files)</td>
      <td>
        Introduce the following modules:<br /><br />
        Braintree payment module<br />
        Braintree Cards Management Page content module
      </td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
    <tr class="success">
      <td><a href="#upg25">WorldPay Modules</a> (2+ files)</td>
      <td>Update the WorldPay Hosted Payment Pages payment module.</td>
      <td></td>
      <td>Low</td>
      <td><a href="http://forums.oscommerce.com/index.php?showuser=2" target="_blank">Harald</a></td>
    </tr>
  </tbody>
</table>

<h3>New Modules</h3>

<p>The following modules have been added:</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Administration Tool Boxes</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg15">Content Modules</a></td>
      <td>Administration page to install and configure Content Modules.</td>
    </tr>
    <tr>
      <td><a href="#upg18">Orders</a></td>
      <td>Orders now has its own box, taken out of the Customers box.</td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>Catalog Boxes</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg19">Payment Acceptance</a></td>
      <td>Shows payment logos that are accepted on the store.</td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>Content Modules</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg15">Set Password (account)</a></td>
      <td>Replace the My Account Change Password link to My Account Set Password if the account was created without a password (eg, through Log In with PayPal).</td>
    </tr>
    <tr>
      <td><a href="#upg21">Sage Pay Cards Management Page (account)</a></td>
      <td>Add a cards management page to My Account to allow customers to manage their stored payment cards.</td>
    </tr>
    <tr>
      <td><a href="#upg23">Stripe Cards Management Page (account)</a></td>
      <td>Add a cards management page to My Account to allow customers to manage their stored payment cards.</td>
    </tr>
    <tr>
      <td><a href="#upg24">Braintree Cards Management Page (account)</a></td>
      <td>Add a cards management page to My Account to allow customers to manage their stored payment cards.</td>
    </tr>
    <tr>
      <td><a href="#upg15">Downloads (checkout_success)</a></td>
      <td>Show download links on the checkout success page if the order status allows downloads.</td>
    </tr>
    <tr>
      <td><a href="#upg15">Product Notifications (checkout_success)</a></td>
      <td>Show product notifications on the checkout success page.</td>
    </tr>
    <tr>
      <td><a href="#upg15">Redirect Old Order (checkout_success)</a></td>
      <td>Redirect to the My Account page if the checkout success page is called after 60 minutes from the customers last order.</td>
    </tr>
    <tr>
      <td><a href="#upg15">Thank You (checkout_success)</a></td>
      <td>Show the thank you text on the checkout success page.</td>
    </tr>
    <tr>
      <td><a href="#upg15">Create Account Link (login)</a></td>
      <td>Show the create account link on the login page for new customers to use.</td>
    </tr>
    <tr>
      <td><a href="#upg15">Login Form (login)</a></td>
      <td>Show the login form on the login page.</td>
    </tr>
    <tr>
      <td><a href="#upg20">Log In with PayPal (login)</a></td>
      <td>Allow customers to be authenticated with their PayPal account.</td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>Payment Modules</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg20">PayPal Payments Pro (Hosted Solution)</a></td>
    </tr>
    <tr>
      <td><a href="#upg22">Authorize.net Direct Post Method (DPM)</a></td>
    </tr>
    <tr>
      <td><a href="#upg23">Stripe.js</a></td>
    </tr>
    <tr>
      <td><a href="#upg24">Braintree</a></td>
    </tr>
  </tbody>
</table>

<h3>Updated Modules</h3>

<p>The following modules have been updated:</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Administration Tool Dashboard Modules</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg17">Latest News</a></td>
    </tr>
    <tr>
      <td><a href="#upg17">Latest Add-Ons</a></td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>Payment Modules</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg20">PayPal Express Checkout</a></td>
    </tr>
    <tr>
      <td><a href="#upg20">PayPal Payments Standard</a></td>
    </tr>
    <tr>
      <td><a href="#upg20">PayPal Payments Pro (Direct Payment)</a></td>
    </tr>
    <tr>
      <td><a href="#upg20">PayPal Express Checkout (Payflow Edition)</a></td>
    </tr>
    <tr>
      <td><a href="#upg20">PayPal Payments Pro (Payflow Edition)</a></td>
    </tr>
    <tr>
      <td><a href="#upg21">Sage Pay Direct</a></td>
    </tr>
    <tr>
      <td><a href="#upg21">Sage Pay Form</a></td>
    </tr>
    <tr>
      <td><a href="#upg21">Sage Pay Server</a></td>
    </tr>
    <tr>
      <td><a href="#upg22">Authorize.net Server Integration Method (SIM)</a></td>
    </tr>
    <tr>
      <td><a href="#upg22">Authorize.net Advanced Integration Method (AIM)</a></td>
    </tr>
    <tr>
      <td><a href="#upg25">WorldPay Hosted Payment Pages</a></td>
    </tr>
  </tbody>
</table>

<h3>External Library Updates</h3>

<p>The following external libraries have been updated:</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Title</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#upg2">jQuery</a></td>
      <td>1.8.0 to 1.11.1.</td>
    </tr>
    <tr>
      <td><a href="#upg1">jQuery UI</a></td>
      <td>1.8.22 to 1.10.4.</td>
    </tr>
    <tr>
      <td><a href="#upg3">Flot (jQuery)</a></td>
      <td>0.6 to 0.8.3.</td>
    </tr>
    <tr>
      <td><a href="#upg4">bxGallery -> PhotosetGrid</a></td>
      <td>bxGallery has been replaced by PhotosetGrid.</td>
    </tr>
    <tr>
      <td><a href="#upg4">FancyBox -> Colorbox</a></td>
      <td>FancyBox has been replaced by Colorbox.</td>
    </tr>
  </tbody>
</table>

<h3>API Changes</h3>

<p>The following API changes have been applied:</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Title</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$PHP_SELF</td>
      <td>The value of $PHP_SELF is now set by parsing the requested url through parse_url() and using the 'path' value returned. This value is no longer parsed through basename() to allow pages to be linked to in subdirectories (eg, ext/).</td>
    </tr>
    <tr>
      <td>Session Lifetime</td>
      <td>The database based session lifetime now matches the file based session life time for a consistent behaviour. Old sessions are now cleaned up automatically by PHP's session garbage collection settings.</td>
    </tr>
    <tr>
      <td>Cookie Based Sessions</td>
      <td>The GET and POST session values are ignored when force cookie based sessions is enabled.</td>
    </tr>
    <tr>
      <td>SHIPPING_ALLOW_UNDEFINED_ZONES</td>
      <td>New configuration parameter to control if orders can be made to destinations without defined shipping rates. (<em>False</em> by default)</em></td>
    </tr>
    <tr>
      <td>Content Modules</td>
      <td>New functions have been added to the template class to manage the new Content Modules implementation.</td>
    </tr>
    <tr>
      <td>Admin Config Parameters</td>
      <td>
        The following parameters have been added to admin/includes/configure.php:<br /><br />
        HTTPS_SERVER<br />
        ENABLE_SSL<br />
        HTTP_COOKIE_DOMAIN<br />
        HTTPS_COOKIE_DOMAIN<br />
        HTTP_COOKIE_PATH<br />
        HTTPS_COOKIE_PATH<br />
        DIR_WS_HTTPS_ADMIN
      </td>
    </tr>
  </tbody>
</table>

<h3>Language Definitions</h3>

<p>The following language definitions have been modified:</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Definitions</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>[admin] modules/boxes/modules_content.php</strong><br />
          MODULES_ADMIN_MENU_MODULES_CONTENT</td>
      <td><br />New</td>
    </tr>
    <tr>
      <td><strong>[admin] modules_content.php</strong><br />
          HEADING_TITLE<br />
          TABLE_HEADING_MODULES<br />
          TABLE_HEADING_GROUP<br />
          TABLE_HEADING_SORT_ORDER<br />
          TABLE_HEADING_ACTION<br />
          TEXT_INFO_VERSION<br />
          TEXT_INFO_ONLINE_STATUS<br />
          TEXT_INFO_API_VERSION<br />
          TEXT_MODULE_DIRECTORY</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>checkout_shipping.php</strong><br />
          ERROR_NO_SHIPPING_AVAILABLE_TO_SHIPPING_ADDRESS</td>
      <td><br />New</td>
    </tr>
    <tr>
      <td><strong>checkout_success.php</strong><br />
          TEXT_SUCCESS<br />
          TEXT_NOTIFY_PRODUCTS<br />
          TEXT_SEE_ORDERS<br />
          TEXT_CONTACT_STORE_OWNER<br />
          TEXT_THANKS_FOR_SHOPPING<br />
          TABLE_HEADING_DOWNLOAD_DATE<br />
          TABLE_HEADING_DOWNLOAD_COUNT<br />
          HEADING_DOWNLOAD<br />
          FOOTER_DOWNLOAD</td>
      <td><br />Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted</td>
    </tr>
    <tr>
      <td><strong>login.php</strong><br />
          HEADING_NEW_CUSTOMER<br />
          TEXT_NEW_CUSTOMER<br />
          TEXT_NEW_CUSTOMER_INTRODUCTION<br />
          HEADING_RETURNING_CUSTOMER<br />
          TEXT_RETURNING_CUSTOMER<br />
          TEXT_PASSWORD_FORGOTTEN<br />
          TEXT_LOGIN_ERROR<br />
          TEXT_VISITORS_CART</td>
      <td><br />Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted<br />
                Deleted</td>
    </tr>
    <tr>
      <td><strong>modules/boxes/bm_card_acceptance.php</strong><br />
          MODULE_BOXES_CARD_ACCEPTANCE_TITLE<br />
          MODULE_BOXES_CARD_ACCEPTANCE_DESCRIPTION<br />
          MODULE_BOXES_CARD_ACCEPTANCE_SHOWN_CARDS<br />
          MODULE_BOXES_CARD_ACCEPTANCE_NEW_CARDS<br />
          MODULE_BOXES_CARD_ACCEPTANCE_DRAG_HERE<br />
          MODULE_BOXES_CARD_ACCEPTANCE_BOX_TITLE</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/account/cm_account_set_password.php</strong><br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_TITLE<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_DESCRIPTION<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_SET_PASSWORD_LINK_TITLE<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_NAVBAR_TITLE_1<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_NAVBAR_TITLE_2<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_HEADING_TITLE<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_SET_PASSWORD_TITLE<br />
          MODULE_CONTENT_ACCOUNT_SET_PASSWORD_SUCCESS_PASSWORD_SET</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/checkout_success/cm_cs_downloads.php</strong><br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_DOWNLOADS_TITLE<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_DOWNLOADS_DESCRIPTION<br />
          TABLE_HEADING_DOWNLOAD_DATE<br />
          TABLE_HEADING_DOWNLOAD_COUNT<br />
          HEADING_DOWNLOAD<br />
          FOOTER_DOWNLOAD</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/checkout_success/cm_cs_product_notifications.php</strong><br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_PRODUCT_NOTIFICATIONS_TITLE<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_PRODUCT_NOTIFICATIONS_DESCRIPTION<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_PRODUCT_NOTIFICATIONS_TEXT_NOTIFY_PRODUCTS</td>
      <td><br />New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/checkout_success/cm_cs_redirect_old_order.php</strong><br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_REDIRECT_OLD_ORDER_TITLE<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_REDIRECT_OLD_ORDER_DESCRIPTION</td>
      <td><br />New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/checkout_success/cm_cs_thank_you.php</strong><br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_THANK_YOU_TITLE<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_THANK_YOU_DESCRIPTION<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_SUCCESS<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_SEE_ORDERS<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_CONTACT_STORE_OWNER<br />
          MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_THANKS_FOR_SHOPPING</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/login/cm_create_account_link.php</strong><br />
          MODULE_CONTENT_CREATE_ACCOUNT_LINK_TITLE<br />
          MODULE_CONTENT_CREATE_ACCOUNT_LINK_DESCRIPTION<br />
          MODULE_CONTENT_LOGIN_HEADING_NEW_CUSTOMER<br />
          MODULE_CONTENT_LOGIN_TEXT_NEW_CUSTOMER<br />
          MODULE_CONTENT_LOGIN_TEXT_NEW_CUSTOMER_INTRODUCTION</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
    <tr>
      <td><strong>modules/content/login/cm_login_form.php</strong><br />
          MODULE_CONTENT_LOGIN_FORM_TITLE<br />
          MODULE_CONTENT_LOGIN_FORM_DESCRIPTION<br />
          MODULE_CONTENT_LOGIN_HEADING_RETURNING_CUSTOMER<br />
          MODULE_CONTENT_LOGIN_TEXT_RETURNING_CUSTOMER<br />
          MODULE_CONTENT_LOGIN_TEXT_PASSWORD_FORGOTTEN<br />
          MODULE_CONTENT_LOGIN_TEXT_LOGIN_ERROR</td>
      <td><br />New<br />
                New<br />
                New<br />
                New<br />
                New<br />
                New</td>
    </tr>
  </tbody>
</table>

<h3>Modified Files</h3>

<p>Files that have been modified in this release include:</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Modified Files</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>account.php</td>
    </tr>
    <tr>
      <td>admin/cache.php</td>
    </tr>
    <tr>
      <td>admin/categories.php</td>
    </tr>
    <tr>
      <td>admin/images/icon_facebook.png</td>
    </tr>
    <tr>
      <td>admin/images/icon_twitter.png</td>
    </tr>
    <tr>
      <td>admin/includes/application_top.php</td>
    </tr>
    <tr>
      <td>admin/includes/boxes/customers.php</td>
    </tr>
    <tr>
      <td>admin/includes/classes/split_page_results.php</td>
    </tr>
    <tr>
      <td>admin/includes/column_left.php</td>
    </tr>
    <tr>
      <td>admin/includes/functions/general.php</td>
    </tr>
    <tr>
      <td>admin/includes/functions/html_output.php</td>
    </tr>
    <tr>
      <td>admin/includes/functions/sessions.php</td>
    </tr>
    <tr>
      <td>admin/includes/header.php</td>
    </tr>
    <tr>
      <td>admin/includes/languages/english.php</td>
    </tr>
    <tr>
      <td>admin/includes/languages/english/modules/dashboard/d_latest_addons.php</td>
    </tr>
    <tr>
      <td>admin/includes/languages/english/modules/dashboard/d_latest_news.php</td>
    </tr>
    <tr>
      <td>admin/includes/modules/dashboard/d_latest_addons.php</td>
    </tr>
    <tr>
      <td>admin/includes/modules/dashboard/d_latest_news.php</td>
    </tr>
    <tr>
      <td>admin/includes/modules/security_check/extended/admin_backup_directory_listing.php</td>
    </tr>
    <tr>
      <td>admin/includes/modules/security_check/extended/admin_backup_file.php</td>
    </tr>
    <tr>
      <td>admin/includes/modules/security_check/extended/ext_directory_listing.php</td>
    </tr>
    <tr>
      <td>admin/includes/template_top.php</td>
    </tr>
    <tr>
      <td>admin/invoice.php</td>
    </tr>
    <tr>
      <td>admin/modules.php</td>
    </tr>
    <tr>
      <td>admin/packingslip.php</td>
    </tr>
    <tr>
      <td>admin/products_attributes.php</td>
    </tr>
    <tr>
      <td>admin/reviews.php</td>
    </tr>
    <tr>
      <td>admin/specials.php</td>
    </tr>
    <tr>
      <td>admin/stats_customers.php</td>
    </tr>
    <tr>
      <td>admin/stats_products_purchased.php</td>
    </tr>
    <tr>
      <td>admin/stats_products_viewed.php</td>
    </tr>
    <tr>
      <td>admin/whos_online.php</td>
    </tr>
    <tr>
      <td>checkout_confirmation.php</td>
    </tr>
    <tr>
      <td>checkout_payment.php</td>
    </tr>
    <tr>
      <td>checkout_shipping.php</td>
    </tr>
    <tr>
      <td>checkout_success.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/express.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/express_payflow.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/standard_ipn.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/rbsworldpay/hosted_callback.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/sage_pay/checkout.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/sage_pay/errors.php</td>
    </tr>
    <tr>
      <td>includes/application_top.php</td>
    </tr>
    <tr>
      <td>includes/classes/navigation_history.php</td>
    </tr>
    <tr>
      <td>includes/classes/osc_template.php</td>
    </tr>
    <tr>
      <td>includes/classes/split_page_results.php</td>
    </tr>
    <tr>
      <td>includes/functions/general.php</td>
    </tr>
    <tr>
      <td>includes/functions/sessions.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/checkout_shipping.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/checkout_success.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/login.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/authorizenet_cc_aim.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/authorizenet_cc_sim.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/paypal_express.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/paypal_pro_dp.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/paypal_pro_payflow_dp.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/paypal_pro_payflow_ec.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/paypal_standard.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/rbsworldpay_hosted.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/sage_pay_direct.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/sage_pay_form.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/sage_pay_server.php</td>
    </tr>
    <tr>
      <td>includes/modules/boxes/bm_currencies.php</td>
    </tr>
    <tr>
      <td>includes/modules/boxes/bm_languages.php</td>
    </tr>
    <tr>
      <td>includes/modules/boxes/bm_order_history.php</td>
    </tr>
    <tr>
      <td>includes/modules/boxes/bm_product_notifications.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/authorizenet_cc_aim.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/authorizenet_cc_sim.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/paypal_express.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/paypal_pro_dp.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/paypal_pro_payflow_dp.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/paypal_pro_payflow_ec.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/paypal_standard.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/rbsworldpay_hosted.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/sage_pay_direct.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/sage_pay_form.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/sage_pay_server.php</td>
    </tr>
    <tr>
      <td>includes/modules/product_listing.php</td>
    </tr>
    <tr>
      <td>includes/template_top.php</td>
    </tr>
    <tr>
      <td>includes/version.php</td>
    </tr>
    <tr>
      <td>login.php</td>
    </tr>
    <tr>
      <td>logoff.php</td>
    </tr>
    <tr>
      <td>product_info.php</td>
    </tr>
    <tr>
      <td>stylesheet.css</td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>New Files</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>admin/images/icon_google_plus.png</td>
    </tr>
    <tr>
      <td>admin/images/icon_oscommerce.png</td>
    </tr>
    <tr>
      <td>admin/includes/boxes/modules_content.php</td>
    </tr>
    <tr>
      <td>admin/includes/boxes/orders.php</td>
    </tr>
    <tr>
      <td>admin/includes/languages/english/modules/boxes/modules_content.php</td>
    </tr>
    <tr>
      <td>admin/includes/languages/english/modules_content.php</td>
    </tr>
    <tr>
      <td>admin/modules_content.php</td>
    </tr>
    <tr>
      <td>ext/modules/content/account/braintree/cards.php</td>
    </tr>
    <tr>
      <td>ext/modules/content/account/sage_pay/cards.php</td>
    </tr>
    <tr>
      <td>ext/modules/content/account/set_password.php</td>
    </tr>
    <tr>
      <td>ext/modules/content/account/stripe/cards.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/authorizenet/authorize.net.crt</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/hosted_checkout.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/images/hss_load.gif</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/paypal.com.crt</td>
    </tr>
    <tr>
      <td>ext/modules/payment/paypal/pro_hosted_ipn.php</td>
    </tr>
    <tr>
      <td>ext/modules/payment/sage_pay/server.php</td>
    </tr>
    <tr>
      <td>images/card_acceptance/american_express.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/cirrus.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/cirrus_transparent.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/discover.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/maestro.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/maestro_transparent.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/mastercard.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/mastercard_transparent.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/paypal.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/paypal_horizontal_large.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/paypal_monogram.png</td>
    </tr>
    <tr>
      <td>images/card_acceptance/visa.png</td>
    </tr>
    <tr>
      <td>includes/cacert.pem</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/boxes/bm_card_acceptance.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/account/cm_account_braintree_cards.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/account/cm_account_sage_pay_cards.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/account/cm_account_set_password.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/account/cm_account_stripe_cards.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/checkout_success/cm_cs_downloads.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/checkout_success/cm_cs_product_notifications.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/checkout_success/cm_cs_redirect_old_order.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/checkout_success/cm_cs_thank_you.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/login/cm_create_account_link.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/login/cm_login_form.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/content/login/cm_paypal_login.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/authorizenet_cc_dpm.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/braintree_cc.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/paypal_pro_hs.php</td>
    </tr>
    <tr>
      <td>includes/languages/english/modules/payment/stripe.php</td>
    </tr>
    <tr>
      <td>includes/modules/boxes/bm_card_acceptance.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/account/cm_account_braintree_cards.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/account/cm_account_sage_pay_cards.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/account/cm_account_set_password.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/account/cm_account_stripe_cards.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/checkout_success/cm_cs_downloads.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/checkout_success/cm_cs_product_notifications.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/checkout_success/cm_cs_redirect_old_order.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/checkout_success/cm_cs_thank_you.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/checkout_success/templates/product_notifications.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/checkout_success/templates/thank_you.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/login/cm_create_account_link.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/login/cm_login_form.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/login/cm_paypal_login.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/login/templates/create_account_link.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/login/templates/login_form.php</td>
    </tr>
    <tr>
      <td>includes/modules/content/login/templates/paypal_login.php</td>
    </tr>
    <tr>
      <td>includes/modules/pages/tp_account.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/authorizenet_cc_dpm.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/braintree_cc.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/braintree_cc/*</td>
    </tr>
    <tr>
      <td>includes/modules/payment/paypal_pro_hs.php</td>
    </tr>
    <tr>
      <td>includes/modules/payment/stripe.php</td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>Deleted Files</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>admin/ext/modules/payment/paypal/paypal_express.php</td>
    </tr>
  </tbody>
</table>

<h2>File Changes</h2>

<span id="upg1"></span>

<h3 class="notoc">jQuery UI (2+ files)</h3>

<p>This changeset updates the jQuery UI javascript library and theme from v1.8.22 to v1.10.4 and removes a bug fix workaround the earlier version introduced.</p>

<p>Delete the following directories and files:</p>

<p>
  <i class="icon-folder-open"></i> <strong>ext/jquery/ui/i18n</strong><br />
  <i class="icon-file"></i> <strong>ext/jquery/ui/jquery-ui-1.8.22.min.js</strong><br />
  <i class="icon-folder-open"></i> <strong>ext/jquery/ui/redmond</strong>
</p>

<p>Copy the following directories and files to their respective destination:</p>

<p>
  <i class="icon-folder-open"></i> <strong>ext/jquery/ui/i18n</strong><br />
  <i class="icon-file"></i> <strong>ext/jquery/ui/jquery-ui-1.10.4.min.js</strong><br />
  <i class="icon-folder-open"></i> <strong>ext/jquery/ui/redmond</strong>
</p>

<p>In:</p>

<p><i class="icon-file"></i> <strong>admin/includes/template_top.php</strong></p>

<p>around line 21, change from:</p>

{code}
<link rel="stylesheet" type="text/css" href="<?php echo tep_catalog_href_link('ext/jquery/ui/redmond/jquery-ui-1.8.22.css'); ?>">
{code}

<p>to:</p>

{code}
<link rel="stylesheet" type="text/css" href="<?php echo tep_catalog_href_link('ext/jquery/ui/redmond/jquery-ui-1.10.4.min.css'); ?>">
{code}

<p>around line 23, change from:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/ui/jquery-ui-1.8.22.min.js'); ?>"></script>

<script type="text/javascript">
// fix jQuery 1.8.0 and jQuery UI 1.8.22 bug with dialog buttons; http://bugs.jqueryui.com/ticket/8484
if ( $.attrFn ) { $.attrFn.text = true; }
</script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/ui/jquery-ui-1.10.4.min.js'); ?>"></script>
{code}

<p><i class="icon-file"></i> <strong>includes/template_top.php</strong></p>

<p>around line 29, change from:</p>

{code}
<link rel="stylesheet" type="text/css" href="ext/jquery/ui/redmond/jquery-ui-1.8.22.css" />
{code}

<p>to:</p>

{code}
<link rel="stylesheet" type="text/css" href="ext/jquery/ui/redmond/jquery-ui-1.10.4.min.css" />
{code}

<p>around line 31, change from:</p>

{code}
<script type="text/javascript" src="ext/jquery/ui/jquery-ui-1.8.22.min.js"></script>
<script type="text/javascript">
// fix jQuery 1.8.0 and jQuery UI 1.8.22 bug with dialog buttons; http://bugs.jqueryui.com/ticket/8484
if ( $.attrFn ) { $.attrFn.text = true; }
</script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="ext/jquery/ui/jquery-ui-1.10.4.min.js"></script>
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/5ee55e94be2bb333fc237fe8b8880461c3a40247" target="_blank">View online at GitHub</a></p>

<span id="upg2"></span>

<h3 class="notoc">jQuery (2+ files)</h3>

<p>This changeset updates the jQuery javascript library from v1.8.0 to v1.11.1.</td>

<p>Delete the following file:</p>

<p><i class="icon-file"></i> <strong>ext/jquery/jquery-1.8.0.min.js</strong></p>

<p>Copy the following file to its respective destination:</p>

<p><i class="icon-file"></i> <strong>ext/jquery/jquery-1.11.1.min.js</strong></p>

<p>In:</p>

<p><i class="icon-file"></i> <strong>admin/includes/template_top.php</strong></p>

<p>around line 22, change from:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/jquery-1.8.0.min.js'); ?>"></script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/jquery-1.11.1.min.js'); ?>"></script>
{code}

<p><i class="icon-file"></i> <strong>includes/template_top.php</strong></p>

<p>around line 30, change from:</p>

{code}
<script type="text/javascript" src="ext/jquery/jquery-1.8.0.min.js"></script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="ext/jquery/jquery-1.11.1.min.js"></script>
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/14b3b429c6a1d16b833b42bb9993b034c89dee5e" target="_blank">View online at GitHub</a></p>

<span id="upg3"></span>

<h3 class="notoc">Flot (jQuery Library) (1+ files)</h3>

<p>This changeset updates the Flot jQuery library from v0.6 to v0.8.3.</td>

<p>Delete the following directory:</p>

<p><i class="icon-file"></i> <strong>ext/flot</strong></p>

<p>Copy the following directory to its respective destination:</p>

<p><i class="icon-file"></i> <strong>ext/flot</strong></p>

<p>In:</p>

<p><i class="icon-file"></i> <strong>admin/includes/template_top.php</strong></p>

<p>around line 36, change from:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.js'); ?>"></script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.time.min.js'); ?>"></script>
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/07aea1213ff5425a2eacf4dc4593932f236e91c3" target="_blank">View online at GitHub</a></p>

<span id="upg4"></span>

<h3 class="notoc">PhotosetGrid and ColorBox (3+ files)</h3>

<p>This changeset replaces the bxGallery and FancyBox jQuery libraries with PhotosetGrid and Colorbox jQuery libraries.</p>

<p>Delete the following directories:</p>

<p>
  <i class="icon-folder-open"></i> <strong>ext/jquery/bxGallery</strong><br />
  <i class="icon-folder-open"></i> <strong>ext/jquery/fancybox</strong>
</p>

<p>Copy the following directories to their respective destination:</p>

<p>
  <i class="icon-folder-open"></i> <strong>ext/colorbox</strong><br />
  <i class="icon-folder-open"></i> <strong>ext/photoset-grid</strong>
</p>

<p>In:</p>

<p><i class="icon-file"></i> <strong>includes/template_top.php</strong></p>

<p>around line 44, change from:</p>

{code}
<script type="text/javascript" src="ext/jquery/bxGallery/jquery.bxGallery.1.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="ext/jquery/fancybox/jquery.fancybox-1.3.4.css" />
<script type="text/javascript" src="ext/jquery/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="ext/photoset-grid/jquery.photoset-grid.min.js"></script>

<link rel="stylesheet" type="text/css" href="ext/colorbox/colorbox.css" />
<script type="text/javascript" src="ext/colorbox/jquery.colorbox-min.js"></script>
{code}

<p><i class="icon-file"></i> <strong>product_info.php</strong></p>

<p>around line 69, change from:</p>

{code}
<?php
    if (tep_not_null($product_info['products_image'])) {
      $pi_query = tep_db_query("select image, htmlcontent from " . TABLE_PRODUCTS_IMAGES . " where products_id = '" . (int)$product_info['products_id'] . "' order by sort_order");

      if (tep_db_num_rows($pi_query) > 0) {
?>

    <div id="piGal" style="float: right;">
      <ul>

<?php
        $pi_counter = 0;
        while ($pi = tep_db_fetch_array($pi_query)) {
          $pi_counter++;

          $pi_entry = '        <li><a href="';

          if (tep_not_null($pi['htmlcontent'])) {
            $pi_entry .= '#piGalimg_' . $pi_counter;
          } else {
            $pi_entry .= tep_href_link(DIR_WS_IMAGES . $pi['image'], '', 'NONSSL', false);
          }

          $pi_entry .= '" target="_blank" rel="fancybox">' . tep_image(DIR_WS_IMAGES . $pi['image']) . '</a>';

          if (tep_not_null($pi['htmlcontent'])) {
            $pi_entry .= '<div style="display: none;"><div id="piGalimg_' . $pi_counter . '">' . $pi['htmlcontent'] . '</div></div>';
          }

          $pi_entry .= '</li>';

          echo $pi_entry;
        }
?>

      </ul>
    </div>

<script type="text/javascript">
$('#piGal ul').bxGallery({
  maxwidth: 300,
  maxheight: 200,
  thumbwidth: <?php echo (($pi_counter > 1) ? '75' : '0'); ?>,
  thumbcontainer: 300,
  load_image: 'ext/jquery/bxGallery/spinner.gif'
});
</script>

<?php
      } else {
?>

    <div id="piGal" style="float: right;">
      <?php echo '<a href="' . tep_href_link(DIR_WS_IMAGES . $product_info['products_image'], '', 'NONSSL', false) . '" target="_blank" rel="fancybox">' . tep_image(DIR_WS_IMAGES . $product_info['products_image'], addslashes($product_info['products_name']), null, null, 'hspace="5" vspace="5"') . '</a>'; ?>
    </div>

<?php
      }
?>

<script type="text/javascript">
$("#piGal a[rel^='fancybox']").fancybox({
  cyclic: true
});
</script>

<?php
    }
?>
{code}

<p>to:</p>

{code}
<?php
    if (tep_not_null($product_info['products_image'])) {
      $photoset_layout = '1';

      $pi_query = tep_db_query("select image, htmlcontent from " . TABLE_PRODUCTS_IMAGES . " where products_id = '" . (int)$product_info['products_id'] . "' order by sort_order");
      $pi_total = tep_db_num_rows($pi_query);

      if ($pi_total > 0) {
        $pi_sub = $pi_total-1;

        while ($pi_sub > 5) {
          $photoset_layout .= 5;
          $pi_sub = $pi_sub-5;
        }

        if ($pi_sub > 0) {
          $photoset_layout .= ($pi_total > 5) ? 5 : $pi_sub;
        }
?>

    <div id="piGal">

<?php
        $pi_counter = 0;
        $pi_html = array();

        while ($pi = tep_db_fetch_array($pi_query)) {
          $pi_counter++;

          if (tep_not_null($pi['htmlcontent'])) {
            $pi_html[] = '<div id="piGalDiv_' . $pi_counter . '">' . $pi['htmlcontent'] . '</div>';
          }

          echo tep_image(DIR_WS_IMAGES . $pi['image'], '', '', '', 'id="piGalImg_' . $pi_counter . '"');
        }
?>

    </div>

<?php
        if ( !empty($pi_html) ) {
          echo '    <div style="display: none;">' . implode('', $pi_html) . '</div>';
        }
      } else {
?>

    <div id="piGal">
      <?php echo tep_image(DIR_WS_IMAGES . $product_info['products_image'], addslashes($product_info['products_name'])); ?>
    </div>

<?php
      }
    }
?>

<script type="text/javascript">
$(function() {
  $('#piGal').css({
    'visibility': 'hidden'
  });

  $('#piGal').photosetGrid({
    layout: '<?php echo $photoset_layout; ?>',
    width: '250px',
    highresLinks: true,
    rel: 'pigallery',
    onComplete: function() {
      $('#piGal').css({ 'visibility': 'visible'});

      $('#piGal a').colorbox({
        maxHeight: '90%',
        maxWidth: '90%',
        rel: 'pigallery'
      });

      $('#piGal img').each(function() {
        var imgid = $(this).attr('id').substring(9);

        if ( $('#piGalDiv_' + imgid).length ) {
          $(this).parent().colorbox({ inline: true, href: "#piGalDiv_" + imgid });
        }
      });
    }
  });
});
</script>
{code}

<p><i class="icon-file"></i> <strong>stylesheet.css</strong></p>

<p>change the following css definitions from:</p>

{code}
#piGal ul {
  list-style-type: none;
}

#piGal img {
  -webkit-box-shadow: 0px 0px 1px #000;
  -moz-box-shadow: 0px 0px 1px #000;
}

#piGal .outer {
  margin-left: -30px;
}
{code}

<p>to:</p>

{code}
#piGal {
  float: right;
  width: 250px;
}

#piGal img {
  max-width: 250px;
  height: auto;
}
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/e00f70591ea163c9052722bd6328fc56662777d8" target="_blank">View online at GitHub</a></p>

<span id="upg5"></span>

<h3 class="notoc">Administration Tool Boxes (1 file)</h3>

<p>This changeset fixes the height of the Administration Tool boxes to work with the newer jQuery UI javascript library.</p>

<p><i class="icon-file"></i> <strong>admin/includes/column_left.php</strong></p>

<p>around line 74, change from:</p>

{code}
autoHeight: false,
{code}

<p>to:</p>

{code}
heightStyle: 'content',
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/0e9f9c2572d90da7b5d69428fb273b484b6ac6d9" target="_blank">View online at GitHub</a></p>

<span id="upg6"></span>

<h3 class="notoc">Improve $PHP_SELF (11 files)</h3>

<p>This changeset improves the value of $PHP_SELF and keeps the path when the value is used in subdirectories (eg, viewing pages from the ext/ directory).</p>

<p><i class="icon-file"></i> <strong>admin/includes/application_top.php</strong></p>

<p>around line 38, change from:</p>

{code}
$PHP_SELF = (((strlen(ini_get('cgi.fix_pathinfo')) > 0) && ((bool)ini_get('cgi.fix_pathinfo') == false)) || !isset($HTTP_SERVER_VARS['SCRIPT_NAME'])) ? basename($HTTP_SERVER_VARS['PHP_SELF']) : basename($HTTP_SERVER_VARS['SCRIPT_NAME']);
{code}

<p>to:</p>

{code}
$req = parse_url($HTTP_SERVER_VARS['SCRIPT_NAME']);
$PHP_SELF = substr($req['path'], strlen(DIR_WS_ADMIN));
{code}

<p>around line 127, change from:</p>

{code}
$current_page = basename($PHP_SELF);
{code}

<p>to:</p>

{code}
$current_page = $PHP_SELF;
{code}

<p><i class="icon-file"></i> <strong>admin/includes/classes/split_page_results.php</strong></p>

<p>around line 55, change from:</p>

{code}
$display_links = tep_draw_form('pages', basename($PHP_SELF), '', 'get');
{code}

<p>to:</p>

{code}
$display_links = tep_draw_form('pages', $PHP_SELF, '', 'get');
{code}

<p>around line 58, change from:</p>

{code}
$display_links .= '<a href="' . tep_href_link(basename($PHP_SELF), $parameters . $page_name . '=' . ($current_page_number - 1), 'NONSSL') . '" class="splitPageLink">' . PREVNEXT_BUTTON_PREV . '</a>&nbsp;&nbsp;';
{code}

<p>to:</p>

{code}
$display_links .= '<a href="' . tep_href_link($PHP_SELF, $parameters . $page_name . '=' . ($current_page_number - 1), 'NONSSL') . '" class="splitPageLink">' . PREVNEXT_BUTTON_PREV . '</a>&nbsp;&nbsp;';
{code}

<p>around line 66, change from:</p>

{code}
$display_links .= '&nbsp;&nbsp;<a href="' . tep_href_link(basename($PHP_SELF), $parameters . $page_name . '=' . ($current_page_number + 1), 'NONSSL') . '" class="splitPageLink">' . PREVNEXT_BUTTON_NEXT . '</a>';
{code}

<p>to:</p>

{code}
$display_links .= '&nbsp;&nbsp;<a href="' . tep_href_link($PHP_SELF, $parameters . $page_name . '=' . ($current_page_number + 1), 'NONSSL') . '" class="splitPageLink">' . PREVNEXT_BUTTON_NEXT . '</a>';
{code}

<p><i class="icon-file"></i> <strong>includes/application_top.php</strong></p>

<p>around line 47, change from:</p>

{code}
$PHP_SELF = (((strlen(ini_get('cgi.fix_pathinfo')) > 0) && ((bool)ini_get('cgi.fix_pathinfo') == false)) || !isset($HTTP_SERVER_VARS['SCRIPT_NAME'])) ? basename($HTTP_SERVER_VARS['PHP_SELF']) : basename($HTTP_SERVER_VARS['SCRIPT_NAME']);
{code}

<p>to:</p>

{code}
$req = parse_url($HTTP_SERVER_VARS['SCRIPT_NAME']);
$PHP_SELF = substr($req['path'], ($request_type == 'NONSSL') ? strlen(DIR_WS_HTTP_CATALOG) : strlen(DIR_WS_HTTPS_CATALOG));
{code}

<p>around line 317, change from:</p>

{code}
$goto = basename($PHP_SELF);
{code}

<p>to:</p>

{code}
$goto = $PHP_SELF;
{code}

<p>around line 367, change from:</p>

{code}
tep_redirect(tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action', 'notify'))));
{code}

<p>to:</p>

{code}
tep_redirect(tep_href_link($PHP_SELF, tep_get_all_get_params(array('action', 'notify'))));
{code}

<p>around line 377, change from:</p>

{code}
tep_redirect(tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action', 'notify'))));
{code}

<p>to:</p>

{code}
tep_redirect(tep_href_link($PHP_SELF, tep_get_all_get_params(array('action', 'notify'))));
{code}

<p>around line 389, change from:</p>

{code}
tep_redirect(tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action'))));
{code}

<p>to:</p>

{code}
tep_redirect(tep_href_link($PHP_SELF, tep_get_all_get_params(array('action'))));
{code}

<p><i class="icon-file"></i> <strong>includes/classes/navigation_history.php</strong></p>

<p>around line 30, change from:</p>

{code}
if ( ($this->path[$i]['page'] == basename($PHP_SELF)) ) {
{code}

<p>to:</p>

{code}
if ($this->path[$i]['page'] == $PHP_SELF) {
{code}

<p>around line 61, change from:</p>

{code}
$this->path[] = array('page' => basename($PHP_SELF),
{code}

<p>to:</p>

{code}
$this->path[] = array('page' => $PHP_SELF,
{code}

<p>around line 72, change from:</p>

{code}
if ($this->path[$last_entry_position]['page'] == basename($PHP_SELF)) {
{code}

<p>to:</p>

{code}
if ($this->path[$last_entry_position]['page'] == $PHP_SELF) {
{code}

<p>around line 86, change from:</p>

{code}
$this->snapshot = array('page' => basename($PHP_SELF),
{code}

<p>to:</p>

{code}
$this->snapshot = array('page' => $PHP_SELF,
{code}

<p><i class="icon-file"></i> <strong>includes/classes/split_page_results.php</strong></p>

<p>around line 83, change from:</p>

{code}
if ($this->current_page_number > 1) $display_links_string .= '<a href="' . tep_href_link(basename($PHP_SELF), $parameters . $this->page_name . '=' . ($this->current_page_number - 1), $request_type) . '" class="pageResults" title=" ' . PREVNEXT_TITLE_PREVIOUS_PAGE . ' "><u>' . PREVNEXT_BUTTON_PREV . '</u></a>&nbsp;&nbsp;';
{code}

<p>to:</p>

{code}
if ($this->current_page_number > 1) $display_links_string .= '<a href="' . tep_href_link($PHP_SELF, $parameters . $this->page_name . '=' . ($this->current_page_number - 1), $request_type) . '" class="pageResults" title=" ' . PREVNEXT_TITLE_PREVIOUS_PAGE . ' "><u>' . PREVNEXT_BUTTON_PREV . '</u></a>&nbsp;&nbsp;';
{code}

<p>around line 93, change from:</p>

{code}
if ($cur_window_num > 1) $display_links_string .= '<a href="' . tep_href_link(basename($PHP_SELF), $parameters . $this->page_name . '=' . (($cur_window_num - 1) * $max_page_links), $request_type) . '" class="pageResults" title=" ' . sprintf(PREVNEXT_TITLE_PREV_SET_OF_NO_PAGE, $max_page_links) . ' ">...</a>';
{code}

<p>to:</p>

{code}
if ($cur_window_num > 1) $display_links_string .= '<a href="' . tep_href_link($PHP_SELF, $parameters . $this->page_name . '=' . (($cur_window_num - 1) * $max_page_links), $request_type) . '" class="pageResults" title=" ' . sprintf(PREVNEXT_TITLE_PREV_SET_OF_NO_PAGE, $max_page_links) . ' ">...</a>';
{code}

<p>around line 100, change from:</p>

{code}
$display_links_string .= '&nbsp;<a href="' . tep_href_link(basename($PHP_SELF), $parameters . $this->page_name . '=' . $jump_to_page, $request_type) . '" class="pageResults" title=" ' . sprintf(PREVNEXT_TITLE_PAGE_NO, $jump_to_page) . ' "><u>' . $jump_to_page . '</u></a>&nbsp;';
{code}

<p>to:</p>

{code}
$display_links_string .= '&nbsp;<a href="' . tep_href_link($PHP_SELF, $parameters . $this->page_name . '=' . $jump_to_page, $request_type) . '" class="pageResults" title=" ' . sprintf(PREVNEXT_TITLE_PAGE_NO, $jump_to_page) . ' "><u>' . $jump_to_page . '</u></a>&nbsp;';
{code}

<p>around line 105, change from:</p>

{code}
if ($cur_window_num < $max_window_num) $display_links_string .= '<a href="' . tep_href_link(basename($PHP_SELF), $parameters . $this->page_name . '=' . (($cur_window_num) * $max_page_links + 1), $request_type) . '" class="pageResults" title=" ' . sprintf(PREVNEXT_TITLE_NEXT_SET_OF_NO_PAGE, $max_page_links) . ' ">...</a>&nbsp;';
{code}

<p>to:</p>

{code}
if ($cur_window_num < $max_window_num) $display_links_string .= '<a href="' . tep_href_link($PHP_SELF, $parameters . $this->page_name . '=' . (($cur_window_num) * $max_page_links + 1), $request_type) . '" class="pageResults" title=" ' . sprintf(PREVNEXT_TITLE_NEXT_SET_OF_NO_PAGE, $max_page_links) . ' ">...</a>&nbsp;';
{code}

<p>around line 108, change from:</p>

{code}
if (($this->current_page_number < $this->number_of_pages) && ($this->number_of_pages != 1)) $display_links_string .= '&nbsp;<a href="' . tep_href_link(basename($PHP_SELF), $parameters . 'page=' . ($this->current_page_number + 1), $request_type) . '" class="pageResults" title=" ' . PREVNEXT_TITLE_NEXT_PAGE . ' "><u>' . PREVNEXT_BUTTON_NEXT . '</u></a>&nbsp;';
{code}

<p>to:</p>

{code}
if (($this->current_page_number < $this->number_of_pages) && ($this->number_of_pages != 1)) $display_links_string .= '&nbsp;<a href="' . tep_href_link($PHP_SELF, $parameters . 'page=' . ($this->current_page_number + 1), $request_type) . '" class="pageResults" title=" ' . PREVNEXT_TITLE_NEXT_PAGE . ' "><u>' . PREVNEXT_BUTTON_NEXT . '</u></a>&nbsp;';
{code}

<p><i class="icon-file"></i> <strong>includes/functions/general.php</strong></p>

<p>around line 896, change from:</p>

{code}
$sort_prefix = '<a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('page', 'info', 'sort')) . 'page=1&sort=' . $colnum . ($sortby == $colnum . 'a' ? 'd' : 'a')) . '" title="' . tep_output_string(TEXT_SORT_PRODUCTS . ($sortby == $colnum . 'd' || substr($sortby, 0, 1) != $colnum ? TEXT_ASCENDINGLY : TEXT_DESCENDINGLY) . TEXT_BY . $heading) . '" class="productListing-heading">' ;
{code}

<p>to:</p>

{code}
$sort_prefix = '<a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('page', 'info', 'sort')) . 'page=1&sort=' . $colnum . ($sortby == $colnum . 'a' ? 'd' : 'a')) . '" title="' . tep_output_string(TEXT_SORT_PRODUCTS . ($sortby == $colnum . 'd' || substr($sortby, 0, 1) != $colnum ? TEXT_ASCENDINGLY : TEXT_DESCENDINGLY) . TEXT_BY . $heading) . '" class="productListing-heading">' ;
{code}

<p><i class="icon-file"></i> <strong>includes/modules/boxes/bm_currencies.php</strong></p>

<p>around line 55, change from:</p>

{code}
'    ' . tep_draw_form('currencies', tep_href_link(basename($PHP_SELF), '', $request_type, false), 'get') .
{code}

<p>to:</p>

{code}
'    ' . tep_draw_form('currencies', tep_href_link($PHP_SELF, '', $request_type, false), 'get') .
{code}

<p><i class="icon-file"></i> <strong>includes/modules/boxes/bm_languages.php</strong></p>

<p>around line 46, change from:</p>

{code}
$languages_string .= ' <a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('language', 'currency')) . 'language=' . $key, $request_type) . '">' . tep_image(DIR_WS_LANGUAGES .  $value['directory'] . '/images/' . $value['image'], $value['name']) . '</a> ';
{code}

<p>to:</p>

{code}
$languages_string .= ' <a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('language', 'currency')) . 'language=' . $key, $request_type) . '">' . tep_image(DIR_WS_LANGUAGES .  $value['directory'] . '/images/' . $value['image'], $value['name']) . '</a> ';
{code}

<p><i class="icon-file"></i> <strong>includes/modules/boxes/bm_order_history.php</strong></p>

<p>around line 51, change from:</p>

{code}
'    <td align="right" valign="top"><a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action')) . 'action=cust_order&pid=' . $products['products_id']) . '">' . tep_image(DIR_WS_ICONS . 'cart.gif', ICON_CART) . '</a></td>' .
{code}

<p>to:</p>

{code}
'    <td align="right" valign="top"><a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('action')) . 'action=cust_order&pid=' . $products['products_id']) . '">' . tep_image(DIR_WS_ICONS . 'cart.gif', ICON_CART) . '</a></td>' .
{code}

<p><i class="icon-file"></i> <strong>includes/modules/boxes/bm_product_notifications.php</strong></p>

<p>around line 48, change from:</p>

{code}
if ($notification_exists == true) {
  $notif_contents = '<table border="0" cellspacing="0" cellpadding="2" class="ui-widget-content infoBoxContents"><tr><td><a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action')) . 'action=notify_remove', $request_type) . '">' . tep_image(DIR_WS_IMAGES . 'box_products_notifications_remove.gif', IMAGE_BUTTON_REMOVE_NOTIFICATIONS) . '</a></td><td><a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action')) . 'action=notify_remove', $request_type) . '">' . sprintf(MODULE_BOXES_PRODUCT_NOTIFICATIONS_BOX_NOTIFY_REMOVE, tep_get_products_name($HTTP_GET_VARS['products_id'])) .'</a></td></tr></table>';
} else {
  $notif_contents = '<table border="0" cellspacing="0" cellpadding="2" class="ui-widget-content infoBoxContents"><tr><td><a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action')) . 'action=notify', $request_type) . '">' . tep_image(DIR_WS_IMAGES . 'box_products_notifications.gif', IMAGE_BUTTON_NOTIFICATIONS) . '</a></td><td><a href="' . tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action')) . 'action=notify', $request_type) . '">' . sprintf(MODULE_BOXES_PRODUCT_NOTIFICATIONS_BOX_NOTIFY, tep_get_products_name($HTTP_GET_VARS['products_id'])) .'</a></td></tr></table>';
}
{code}

<p>to:</p>

{code}
if ($notification_exists == true) {
  $notif_contents = '<table border="0" cellspacing="0" cellpadding="2" class="ui-widget-content infoBoxContents"><tr><td><a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('action')) . 'action=notify_remove', $request_type) . '">' . tep_image(DIR_WS_IMAGES . 'box_products_notifications_remove.gif', IMAGE_BUTTON_REMOVE_NOTIFICATIONS) . '</a></td><td><a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('action')) . 'action=notify_remove', $request_type) . '">' . sprintf(MODULE_BOXES_PRODUCT_NOTIFICATIONS_BOX_NOTIFY_REMOVE, tep_get_products_name($HTTP_GET_VARS['products_id'])) .'</a></td></tr></table>';
} else {
  $notif_contents = '<table border="0" cellspacing="0" cellpadding="2" class="ui-widget-content infoBoxContents"><tr><td><a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('action')) . 'action=notify', $request_type) . '">' . tep_image(DIR_WS_IMAGES . 'box_products_notifications.gif', IMAGE_BUTTON_NOTIFICATIONS) . '</a></td><td><a href="' . tep_href_link($PHP_SELF, tep_get_all_get_params(array('action')) . 'action=notify', $request_type) . '">' . sprintf(MODULE_BOXES_PRODUCT_NOTIFICATIONS_BOX_NOTIFY, tep_get_products_name($HTTP_GET_VARS['products_id'])) .'</a></td></tr></table>';
}
{code}

<p><i class="icon-file"></i> <strong>includes/modules/product_listing.php</strong></p>

<p>around line 135, change from:</p>

{code}
$prod_list_contents .= '        <td align="center">' . tep_draw_button(IMAGE_BUTTON_BUY_NOW, 'cart', tep_href_link(basename($PHP_SELF), tep_get_all_get_params(array('action')) . 'action=buy_now&products_id=' . $listing['products_id'])) . '</td>';
{code}

<p>to:</p>

{code}
$prod_list_contents .= '        <td align="center">' . tep_draw_button(IMAGE_BUTTON_BUY_NOW, 'cart', tep_href_link($PHP_SELF, tep_get_all_get_params(array('action')) . 'action=buy_now&products_id=' . $listing['products_id'])) . '</td>';
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/edd2128b605497d0730238daa1df0c40f23152fc" target="_blank">View online at GitHub</a></p>

<span id="upg7"></span>

<h3 class="notoc">Session Lifetime (5 files + SQL)</h3>

<p>This changeset updates the lifetime of database based sessions to match the lifetime of file based sessions for consistent lifetime behaviour, and now relies on the PHP session garbage collection setting for automatic cleanup of old sessions. The security of sessions has also been improved by not accepting GET/POST session IDs if SESSION_FORCE_COOKIE_USE is enabled.</p>

<p><i class="icon-file"></i> <strong>admin/includes/functions/sessions.php</strong><br />
<i class="icon-file"></i> <strong>includes/functions/sessions.php</strong></p>

<div class="achtung">Do not copy the admin sessions.php file to the catalog side as they differ slightly.</div>

<p>in those two files, around line 19, remove the following lines:</p>

{code}
if (!$SESS_LIFE = get_cfg_var('session.gc_maxlifetime')) {
  $SESS_LIFE = 1440;
}
{code}

<p>around line 31, change from:</p>

{code}
function _sess_read($key) {
  $value_query = tep_db_query("select value from " . TABLE_SESSIONS . " where sesskey = '" . tep_db_input($key) . "' and expiry > '" . time() . "'");
  $value = tep_db_fetch_array($value_query);

  if (isset($value['value'])) {
    return $value['value'];
  }

  return '';
}
{code}

<p>to:</p>

{code}
function _sess_read($key) {
  $value_query = tep_db_query("select value from " . TABLE_SESSIONS . " where sesskey = '" . tep_db_input($key) . "'");
  $value = tep_db_fetch_array($value_query);

  if (isset($value['value'])) {
    return $value['value'];
  }

  return '';
}
{code}

<p>around line 42, change from:</p>

{code}
function _sess_write($key, $val) {
  global $SESS_LIFE;

  $expiry = time() + $SESS_LIFE;
  $value = $val;

  $check_query = tep_db_query("select count(*) as total from " . TABLE_SESSIONS . " where sesskey = '" . tep_db_input($key) . "'");
  $check = tep_db_fetch_array($check_query);

  if ($check['total'] > 0) {
    return tep_db_query("update " . TABLE_SESSIONS . " set expiry = '" . tep_db_input($expiry) . "', value = '" . tep_db_input($value) . "' where sesskey = '" . tep_db_input($key) . "'");
  } else {
    return tep_db_query("insert into " . TABLE_SESSIONS . " values ('" . tep_db_input($key) . "', '" . tep_db_input($expiry) . "', '" . tep_db_input($value) . "')");
  }
}
{code}

<p>to:</p>

{code}
function _sess_write($key, $value) {
  $check_query = tep_db_query("select 1 from " . TABLE_SESSIONS . " where sesskey = '" . tep_db_input($key) . "'");

  if ( tep_db_num_rows($check_query) > 0 ) {
    return tep_db_query("update " . TABLE_SESSIONS . " set expiry = '" . tep_db_input(time()) . "', value = '" . tep_db_input($value) . "' where sesskey = '" . tep_db_input($key) . "'");
  } else {
    return tep_db_query("insert into " . TABLE_SESSIONS . " values ('" . tep_db_input($key) . "', '" . tep_db_input(time()) . "', '" . tep_db_input($value) . "')");
  }
}
{code}

<p>around line 62, change from:</p>

{code}
function _sess_gc($maxlifetime) {
  tep_db_query("delete from " . TABLE_SESSIONS . " where expiry < '" . time() . "'");

  return true;
}
{code}

<p>to:</p>

{code}
function _sess_gc($maxlifetime) {
  return tep_db_query("delete from " . TABLE_SESSIONS . " where expiry < '" . (time() - $maxlifetime) . "'");
}
{code}

<p>around line 71, change from:</p>

{code}
function tep_session_start() {
  global $HTTP_GET_VARS, $HTTP_POST_VARS, $HTTP_COOKIE_VARS;

  $sane_session_id = true;

  if (isset($HTTP_GET_VARS[tep_session_name()])) {
    if (preg_match('/^[a-zA-Z0-9,-]+$/', $HTTP_GET_VARS[tep_session_name()]) == false) {
      unset($HTTP_GET_VARS[tep_session_name()]);

      $sane_session_id = false;
    }
  } elseif (isset($HTTP_POST_VARS[tep_session_name()])) {
    if (preg_match('/^[a-zA-Z0-9,-]+$/', $HTTP_POST_VARS[tep_session_name()]) == false) {
      unset($HTTP_POST_VARS[tep_session_name()]);

      $sane_session_id = false;
    }
  } elseif (isset($HTTP_COOKIE_VARS[tep_session_name()])) {
    if (preg_match('/^[a-zA-Z0-9,-]+$/', $HTTP_COOKIE_VARS[tep_session_name()]) == false) {
      $session_data = session_get_cookie_params();

      setcookie(tep_session_name(), '', time()-42000, $session_data['path'], $session_data['domain']);

      $sane_session_id = false;
    }
  }

  if ($sane_session_id == false) {
    tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'NONSSL', false));
  }

  register_shutdown_function('session_write_close');

  return session_start();
}
{code}

<p>to:</p>

{code}
function tep_session_start() {
  global $HTTP_GET_VARS, $HTTP_POST_VARS, $HTTP_COOKIE_VARS;

  $sane_session_id = true;

  if ( isset($HTTP_GET_VARS[tep_session_name()]) ) {
    if ( (SESSION_FORCE_COOKIE_USE == 'True') || (preg_match('/^[a-zA-Z0-9,-]+$/', $HTTP_GET_VARS[tep_session_name()]) == false) ) {
      unset($HTTP_GET_VARS[tep_session_name()]);

      $sane_session_id = false;
    }
  }

  if ( isset($HTTP_POST_VARS[tep_session_name()]) ) {
    if ( (SESSION_FORCE_COOKIE_USE == 'True') || (preg_match('/^[a-zA-Z0-9,-]+$/', $HTTP_POST_VARS[tep_session_name()]) == false) ) {
      unset($HTTP_POST_VARS[tep_session_name()]);

      $sane_session_id = false;
    }
  }

  if ( isset($HTTP_COOKIE_VARS[tep_session_name()]) ) {
    if ( preg_match('/^[a-zA-Z0-9,-]+$/', $HTTP_COOKIE_VARS[tep_session_name()]) == false ) {
      $session_data = session_get_cookie_params();

      setcookie(tep_session_name(), '', time()-42000, $session_data['path'], $session_data['domain']);
      unset($HTTP_COOKIE_VARS[tep_session_name()]);

      $sane_session_id = false;
    }
  }

  if ($sane_session_id == false) {
    tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'NONSSL', false));
  }

  register_shutdown_function('session_write_close');

  return session_start();
}
{code}

<p>around line 161, change from:</p>

{code}
function tep_session_destroy() {
  return session_destroy();
}
{code}

<p>to:</p>

{code}
function tep_session_destroy() {
  global $HTTP_COOKIE_VARS;

  if ( isset($HTTP_COOKIE_VARS[tep_session_name()]) ) {
    $session_data = session_get_cookie_params();

    setcookie(tep_session_name(), '', time()-42000, $session_data['path'], $session_data['domain']);
    unset($HTTP_COOKIE_VARS[tep_session_name()]);
  }

  return session_destroy();
}
{code}

<p><i class="icon-file"></i> <strong>includes/application_top.php</strong></p>

<p>around line 151, change from:</p>

{code}
if (isset($HTTP_POST_VARS[tep_session_name()])) {
  tep_session_id($HTTP_POST_VARS[tep_session_name()]);
} elseif ( ($request_type == 'SSL') && isset($HTTP_GET_VARS[tep_session_name()]) ) {
  tep_session_id($HTTP_GET_VARS[tep_session_name()]);
}
{code}

<p>to:</p>

{code}
if ( SESSION_FORCE_COOKIE_USE == 'False' ) {
  if ( isset($HTTP_GET_VARS[tep_session_name()]) && (!isset($HTTP_COOKIE_VARS[tep_session_name()]) || ($HTTP_COOKIE_VARS[tep_session_name()] != $HTTP_GET_VARS[tep_session_name()])) ) {
    tep_session_id($HTTP_GET_VARS[tep_session_name()]);
  } elseif ( isset($HTTP_POST_VARS[tep_session_name()]) && (!isset($HTTP_COOKIE_VARS[tep_session_name()]) || ($HTTP_COOKIE_VARS[tep_session_name()] != $HTTP_POST_VARS[tep_session_name()])) ) {
    tep_session_id($HTTP_POST_VARS[tep_session_name()]);
  }
}
{code}

<p><i class="icon-file"></i> <strong>login.php</strong></p>

<p>around line 15, change from:</p>

{code}
// redirect the customer to a friendly cookie-must-be-enabled page if cookies are disabled (or the session has not started)
  if ($session_started == false) {
    tep_redirect(tep_href_link(FILENAME_COOKIE_USAGE));
  }
{code}

<p>to:</p>

{code}
// redirect the customer to a friendly cookie-must-be-enabled page if cookies are disabled (or the session has not started)
  if ($session_started == false) {
    if ( !isset($HTTP_GET_VARS['cookie_test']) ) {
      $all_get = tep_get_all_get_params();

      tep_redirect(tep_href_link(FILENAME_LOGIN, $all_get . (empty($all_get) ? '' : '&') . 'cookie_test=1', 'SSL'));
    }

    tep_redirect(tep_href_link(FILENAME_COOKIE_USAGE));
  }
{code}

<p><i class="icon-file"></i> <strong>logoff.php</strong></p>

<p>around line 19, change from:</p>

{code}
tep_session_unregister('customer_id');
tep_session_unregister('customer_default_address_id');
tep_session_unregister('customer_first_name');
tep_session_unregister('customer_country_id');
tep_session_unregister('customer_zone_id');
tep_session_unregister('comments');
{code}

<p>to:</p>

{code}
tep_session_unregister('customer_id');
tep_session_unregister('customer_default_address_id');
tep_session_unregister('customer_first_name');
tep_session_unregister('customer_country_id');
tep_session_unregister('customer_zone_id');

if ( tep_session_is_registered('sendto') ) {
  tep_session_unregister('sendto');
}

if ( tep_session_is_registered('billto') ) {
  tep_session_unregister('billto');
}

if ( tep_session_is_registered('shipping') ) {
  tep_session_unregister('shipping');
}

if ( tep_session_is_registered('payment') ) {
  tep_session_unregister('payment');
}

if ( tep_session_is_registered('comments') ) {
  tep_session_unregister('comments');
}
{code}

<p><i class="icon-list-alt"></i> <strong>Database</strong></p>

<p>Perform the following SQL commands:</p>

{code sql}
alter table sessions modify sesskey varchar(128) not null;
{code}

<p>This increases the session ID column to better support session.hash_function and session.hash_bits_per_character PHP ini settings.</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/770cbdfe35a0276492a93301a92d98f19b4184ff" target="_blank">View online at GitHub</a></p>

<span id="upg8"></span>

<h3 class="notoc">Block Orders With No Shipping (2 files + SQL)</h3>

<p>This changeset allows orders to be blocked when the destination does not match any defined shipping zones and when no shipping rates are available.</p>

<p><i class="icon-file"></i> <strong>checkout_shipping.php</strong></p>

<p>around line 139, change from:</p>

{code}
$shipping = false;

tep_redirect(tep_href_link(FILENAME_CHECKOUT_PAYMENT, '', 'SSL'));
{code}

<p>to:</p>

{code}
if ( defined('SHIPPING_ALLOW_UNDEFINED_ZONES') && (SHIPPING_ALLOW_UNDEFINED_ZONES == 'False') ) {
  tep_session_unregister('shipping');
} else {
  $shipping = false;

  tep_redirect(tep_href_link(FILENAME_CHECKOUT_PAYMENT, '', 'SSL'));
}
{code}

<p>around line 156, change from:</p>

{code}
require(DIR_WS_LANGUAGES . $language . '/' . FILENAME_CHECKOUT_SHIPPING);
{code}

<p>to:</p>

{code}
require(DIR_WS_LANGUAGES . $language . '/' . FILENAME_CHECKOUT_SHIPPING);

if ( defined('SHIPPING_ALLOW_UNDEFINED_ZONES') && (SHIPPING_ALLOW_UNDEFINED_ZONES == 'False') && !tep_session_is_registered('shipping') && ($shipping == false) ) {
  $messageStack->add_session('checkout_address', ERROR_NO_SHIPPING_AVAILABLE_TO_SHIPPING_ADDRESS);

  tep_redirect(tep_href_link(FILENAME_CHECKOUT_SHIPPING_ADDRESS, '', 'SSL'));
}
{code}

<p><i class="icon-file"></i> <strong>includes/languages/english/checkout_shipping.php</strong></p>

<p>add the following language definition:</p>

{code}
define('ERROR_NO_SHIPPING_AVAILABLE_TO_SHIPPING_ADDRESS', 'Shipping is currently not available for the selected shipping address. Please select or create a new shipping address to use with your purchase.');
{code}

<p><i class="icon-list-alt"></i> <strong>Database</strong></p>

<p>Perform the following SQL commands:</p>

{code sql}
insert into configuration (configuration_title, configuration_key, configuration_value, configuration_description, configuration_group_id, sort_order, set_function, date_added) values ('Allow Orders Not Matching Defined Shipping Zones ', 'SHIPPING_ALLOW_UNDEFINED_ZONES', 'False', 'Should orders be allowed to shipping addresses not matching defined shipping module shipping zones?', '7', '5', 'tep_cfg_select_option(array(\'True\', \'False\'), ', now());
{code}

<p>This adds the following configuration parameter:</p>

<p>Administration Tool -> Configuration -> Shipping/Packaging -> Allow Orders Not Matching Defined Shipping Zones (<em>False</em> by default)</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/be113b50aacb3050e7bc22501ec3de41f9bba5b8" target="_blank">View online at GitHub</a></p>

<span id="upg9"></span>

<h3 class="notoc">Product Attributes Administration (1 file)</h3>

<p>This changeset removes a duplicate database query when administrating product attributes.</p>

<p><i class="icon-file"></i> <strong>admin/products_attributes.php</strong></p>

<p>around line 134, change from:</p>

{code}
tep_db_query("delete from " . TABLE_PRODUCTS_OPTIONS_VALUES . " where products_options_values_id = '" . (int)$value_id . "'");
tep_db_query("delete from " . TABLE_PRODUCTS_OPTIONS_VALUES . " where products_options_values_id = '" . (int)$value_id . "'");
tep_db_query("delete from " . TABLE_PRODUCTS_OPTIONS_VALUES_TO_PRODUCTS_OPTIONS . " where products_options_values_id = '" . (int)$value_id . "'");
{code}

<p>to:</p>

{code}
tep_db_query("delete from " . TABLE_PRODUCTS_OPTIONS_VALUES . " where products_options_values_id = '" . (int)$value_id . "'");
tep_db_query("delete from " . TABLE_PRODUCTS_OPTIONS_VALUES_TO_PRODUCTS_OPTIONS . " where products_options_values_id = '" . (int)$value_id . "'");
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/6cc725d31691459d42fd63f9665918d25bee7dd3" target="_blank">View online at GitHub</a></p>

<span id="upg10"></span>

<h3 class="notoc">Remove Free Shipping Check On Non-Related Page (1 file)</h3>

<p>This changeset removes a free shipping check on a non-related page.</p>

<p><i class="icon-file"></i> <strong>checkout_payment.php</strong></p>

<p>around line 176, change from:</p>

{code}
} elseif ($free_shipping == false) {
{code}

<p>to:</p>

{code}
} else {
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/465955b403461f894cafbc4b63142d3be8411962" target="_blank">View online at GitHub</a></p>

<span id="upg11"></span>

<h3 class="notoc">Checkout Confirmation MessageStack (1 file)</h3>

<p>This changeset allows messages added to the message stack to be shown on the checkout confirmation page.</p>

<p><i class="icon-file"></i> <strong>checkout_confirmation.php</strong></p>

<p>around line 96, change from:</p>

{code}
if (isset($$payment->form_action_url)) {
  $form_action_url = $$payment->form_action_url;
} else {
  $form_action_url = tep_href_link(FILENAME_CHECKOUT_PROCESS, '', 'SSL');
}
{code}

<p>to:</p>

{code}
if ($messageStack->size('checkout_confirmation') > 0) {
  echo $messageStack->output('checkout_confirmation');
}

if (isset($$payment->form_action_url)) {
  $form_action_url = $$payment->form_action_url;
} else {
  $form_action_url = tep_href_link(FILENAME_CHECKOUT_PROCESS, '', 'SSL');
}
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/549df3c524103b1480d443fa1392819ea20c323b" target="_blank">View online at GitHub</a></p>

<span id="upg12"></span>

<h3 class="notoc">CA Public Certificate Bundle (1 file)</h3>

<p>This changeset adds the CA public certificate bundle which curl can use to verify secure connections.</p>

<p>Copy the following file to its respective directory:</p>

<p>
  <i class="icon-file"></i> <strong>includes/cacert.pem</strong>
</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/32237c6f2945b9695b952e3ab79face29a66de86" target="_blank">View online at GitHub</a></p>

<span id="upg13"></span>

<h3 class="notoc">Modules Administration (1 file)</h3>

<p>This changeset prevents duplicate module parameters being installed when installed module files were deleted without uninstalling them prior and copying the files back at a later date to install again.</p>

<p><i class="icon-file"></i> <strong>checkout_confirmation.php</strong></p>

<p>around line 48, change from:</p>

{code}
if ($action == 'install') {
  $module->install();

  $modules_installed = explode(';', constant($module_key));
  $modules_installed[] = $class . $file_extension;

  tep_db_query("update " . TABLE_CONFIGURATION . " set configuration_value = '" . implode(';', $modules_installed) . "' where configuration_key = '" . $module_key . "'");
  tep_redirect(tep_href_link(FILENAME_MODULES, 'set=' . $set . '&module=' . $class));
} elseif ($action == 'remove') {
  $module->remove();

  $modules_installed = explode(';', constant($module_key));
  unset($modules_installed[array_search($class . $file_extension, $modules_installed)]);

  tep_db_query("update " . TABLE_CONFIGURATION . " set configuration_value = '" . implode(';', $modules_installed) . "' where configuration_key = '" . $module_key . "'");
  tep_redirect(tep_href_link(FILENAME_MODULES, 'set=' . $set));
}
{code}

<p>to:</p>

{code}
if ($action == 'install') {
  if ($module->check() > 0) { // remove module if already installed
    $module->remove();
  }

  $module->install();

  $modules_installed = explode(';', constant($module_key));

  if (!in_array($class . $file_extension, $modules_installed)) {
    $modules_installed[] = $class . $file_extension;
  }

  tep_db_query("update " . TABLE_CONFIGURATION . " set configuration_value = '" . implode(';', $modules_installed) . "' where configuration_key = '" . $module_key . "'");
  tep_redirect(tep_href_link(FILENAME_MODULES, 'set=' . $set . '&module=' . $class));
} elseif ($action == 'remove') {
  $module->remove();

  $modules_installed = explode(';', constant($module_key));

  if (in_array($class . $file_extension, $modules_installed)) {
    unset($modules_installed[array_search($class . $file_extension, $modules_installed)]);
  }

  tep_db_query("update " . TABLE_CONFIGURATION . " set configuration_value = '" . implode(';', $modules_installed) . "' where configuration_key = '" . $module_key . "'");
  tep_redirect(tep_href_link(FILENAME_MODULES, 'set=' . $set));
}
{code}

<p>around line 181, change from:</p>

{code}
<td class="dataTableContent" align="right"><?php if (is_numeric($module->sort_order)) echo $module->sort_order; ?></td>
{code}

<p>to:</p>

{code}
<td class="dataTableContent" align="right"><?php if (in_array($module->code . $file_extension, $modules_installed) && is_numeric($module->sort_order)) echo $module->sort_order; ?></td>
{code}

<p>around line 249, change from:</p>

{code}
if ($mInfo->status == '1') {
{code}

<p>to:</p>

{code}
if (in_array($mInfo->code . $file_extension, $modules_installed) && ($mInfo->status > 0)) {
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/dd85c7975238a27d19d9850c9f71268ec53d7c54" target="_blank">View online at GitHub</a></p>

<span id="upg14"></span>

<h3 class="notoc">HTTPS Administration Tool (22 files + Config)</h3>

<p>This changeset forces HTTPS for the Administration Tool if SSL has been enabled.</p>

<div class="note">This changeset also introduces additional configuration parameters that must be added to the admin/includes/configure.php file.</div>

<p><i class="icon-file"></i> <strong>admin/includes/configure.php</strong></p>

<p>add the following configuration parameters with your store values:</p>

{code}
define('HTTPS_SERVER', '');
define('ENABLE_SSL', false);
define('HTTP_COOKIE_DOMAIN', '');
define('HTTPS_COOKIE_DOMAIN', '');
define('HTTP_COOKIE_PATH', '');
define('HTTPS_COOKIE_PATH', '');

define('DIR_WS_HTTPS_ADMIN', '/catalog/admin/');
{code}

<div class="info">Please reference your catalog configuration file at <em>includes/configure.php</em> to form the admin equivalent values.</div>

<table class="pretty">
  <thead>
    <tr>
      <th>Configuration Parameter</th>
      <th>Description</th>
      <th>Example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>HTTPS_SERVER</td>
      <td>The HTTPS equivalent of HTTP_SERVER.</td>
      <td><em>https://ssl.oscommerce.com</em></td>
    </tr>
    <tr>
      <td>ENABLE_SSL</td>
      <td>Set to <em>true</em> to enable HTTPS in the Administration Tool.</td>
      <td><em>true</em></td>
    </tr>
    <tr>
      <td>HTTP_COOKIE_DOMAIN</td>
      <td>Limit cookies to this domain - can be left empty.</td>
      <td></td>
    </tr>
    <tr>
      <td>HTTPS_COOKIE_DOMAIN</td>
      <td>Limit cookies to this domain - can be left empty.</td>
      <td></td>
    </tr>
    <tr>
      <td>HTTP_COOKIE_PATH</td>
      <td>Limit cookies to this path - based on DIR_WS_ADMIN.</td>
      <td><em>/catalog/admin/</em></td>
    </tr>
    <tr>
      <td>HTTPS_COOKIE_PATH</td>
      <td>Limit cookies to this domain - based on DIR_WS_HTTPS_ADMIN.</td>
      <td><em>/catalog/admin/</em></td>
    </tr>
    <tr>
      <td>DIR_WS_HTTPS_ADMIN</td>
      <td>The HTTPS equivalent of DIR_WS_ADMIN.</td>
      <td><em>/catalog/admin/</em></td>
    </tr>
  </tbody>
</table>

<p><i class="icon-file"></i> <strong>admin/cache.php</strong></p>

<p>around line 87, change from:</p>

{code}
<td class="dataTableContent" align="right"><?php echo '<a href="' . tep_href_link(FILENAME_CACHE, 'action=reset&block=' . $cache_blocks[$i]['code'], 'NONSSL') . '">' . tep_image(DIR_WS_IMAGES . 'icon_reset.gif', 'Reset', 13, 13) . '</a>'; ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td class="dataTableContent" align="right"><?php echo '<a href="' . tep_href_link(FILENAME_CACHE, 'action=reset&block=' . $cache_blocks[$i]['code']) . '">' . tep_image(DIR_WS_IMAGES . 'icon_reset.gif', 'Reset', 13, 13) . '</a>'; ?>&nbsp;</td>
{code}

<p><i class="icon-file"></i> <strong>admin/categories.php</strong></p>

<p>around line 595, change from:</p>

{code}
<div><?php echo '<strong>' . TEXT_PRODUCTS_MAIN_IMAGE . ' <small>(' . SMALL_IMAGE_WIDTH . ' x ' . SMALL_IMAGE_HEIGHT . 'px)</small></strong><br />' . (tep_not_null($pInfo->products_image) ? '<a href="' . DIR_WS_CATALOG_IMAGES . $pInfo->products_image . '" target="_blank">' . $pInfo->products_image . '</a> &#124; ' : '') . tep_draw_file_field('products_image'); ?></div>
{code}

<p>to:</p>

{code}
<div><?php echo '<strong>' . TEXT_PRODUCTS_MAIN_IMAGE . ' <small>(' . SMALL_IMAGE_WIDTH . ' x ' . SMALL_IMAGE_HEIGHT . 'px)</small></strong><br />' . (tep_not_null($pInfo->products_image) ? '<a href="' . HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . $pInfo->products_image . '" target="_blank">' . $pInfo->products_image . '</a> &#124; ' : '') . tep_draw_file_field('products_image'); ?></div>
{code}

<p>around line 604, change from:</p>

{code}
echo '                <li id="piId' . $pi_counter . '" class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s" style="float: right;"></span><a href="#" onclick="showPiDelConfirm(' . $pi_counter . ');return false;" class="ui-icon ui-icon-trash" style="float: right;"></a><strong>' . TEXT_PRODUCTS_LARGE_IMAGE . '</strong><br />' . tep_draw_file_field('products_image_large_' . $pi['id']) . '<br /><a href="' . DIR_WS_CATALOG_IMAGES . $pi['image'] . '" target="_blank">' . $pi['image'] . '</a><br /><br />' . TEXT_PRODUCTS_LARGE_IMAGE_HTML_CONTENT . '<br />' . tep_draw_textarea_field('products_image_htmlcontent_' . $pi['id'], 'soft', '70', '3', $pi['htmlcontent']) . '</li>';
{code}

<p>to:</p>

{code}
echo '                <li id="piId' . $pi_counter . '" class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s" style="float: right;"></span><a href="#" onclick="showPiDelConfirm(' . $pi_counter . ');return false;" class="ui-icon ui-icon-trash" style="float: right;"></a><strong>' . TEXT_PRODUCTS_LARGE_IMAGE . '</strong><br />' . tep_draw_file_field('products_image_large_' . $pi['id']) . '<br /><a href="' . HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . $pi['image'] . '" target="_blank">' . $pi['image'] . '</a><br /><br />' . TEXT_PRODUCTS_LARGE_IMAGE_HTML_CONTENT . '<br />' . tep_draw_textarea_field('products_image_htmlcontent_' . $pi['id'], 'soft', '70', '3', $pi['htmlcontent']) . '</li>';
{code}

<p>around line 724, change from:</p>

{code}
<td class="main"><?php echo tep_image(DIR_WS_CATALOG_IMAGES . $products_image_name, $pInfo->products_name, SMALL_IMAGE_WIDTH, SMALL_IMAGE_HEIGHT, 'align="right" hspace="5" vspace="5"') . $pInfo->products_description; ?></td>
{code}

<p>to:</p>

{code}
<td class="main"><?php echo tep_image(HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . $products_image_name, $pInfo->products_name, SMALL_IMAGE_WIDTH, SMALL_IMAGE_HEIGHT, 'align="right" hspace="5" vspace="5"') . $pInfo->products_description; ?></td>
{code}

<p>around line 777, change from:</p>

{code}
<td align="right" class="smallText"><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link($back_url, $back_url_params, 'NONSSL')); ?></td>
{code}

<p>to:</p>

{code}
<td align="right" class="smallText"><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link($back_url, $back_url_params)); ?></td>
{code}

<p>around line 956, change from:</p>

{code}
$contents[] = array('text' => '<br />' . tep_image(DIR_WS_CATALOG_IMAGES . $cInfo->categories_image, $cInfo->categories_name) . '<br />' . DIR_WS_CATALOG_IMAGES . '<br /><strong>' . $cInfo->categories_image . '</strong>');
{code}

<p>to:</p>

{code}
$contents[] = array('text' => '<br />' . tep_image(HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . $cInfo->categories_image, $cInfo->categories_name) . '<br />' . DIR_WS_CATALOG_IMAGES . '<br /><strong>' . $cInfo->categories_image . '</strong>');
{code}

<p><i class="icon-file"></i> <strong>admin/includes/application_top.php</strong></p>

<p>around line 37, change from:</p>

{code}
// set php_self in the local scope
  $req = parse_url($HTTP_SERVER_VARS['SCRIPT_NAME']);
  $PHP_SELF = substr($req['path'], strlen(DIR_WS_ADMIN));
{code}

<p>to:</p>

{code}
// set the type of request (secure or not)
  $request_type = (getenv('HTTPS') == 'on') ? 'SSL' : 'NONSSL';

// set php_self in the local scope
  $req = parse_url($HTTP_SERVER_VARS['SCRIPT_NAME']);
  $PHP_SELF = substr($req['path'], ($request_type == 'SSL') ? strlen(DIR_WS_HTTPS_ADMIN) : strlen(DIR_WS_ADMIN));
{code}

<p>around line 83, change from:</p>

{code}
// set the session name and save path
  tep_session_name('osCAdminID');
  tep_session_save_path(SESSION_WRITE_DIRECTORY);
{code}

<p>to:</p>

{code}
// set the cookie domain
  $cookie_domain = (($request_type == 'NONSSL') ? HTTP_COOKIE_DOMAIN : HTTPS_COOKIE_DOMAIN);
  $cookie_path = (($request_type == 'NONSSL') ? HTTP_COOKIE_PATH : HTTPS_COOKIE_PATH);

// set the session name and save path
  tep_session_name('osCAdminID');
  tep_session_save_path(SESSION_WRITE_DIRECTORY);
{code}

<p>around line 89, change from:</p>

{code}
session_set_cookie_params(0, DIR_WS_ADMIN);
{code}

<p>to:</p>

{code}
session_set_cookie_params(0, $cookie_path, $cookie_domain);
{code}

<p>around line 92, change from:</p>

{code}
ini_set('session.cookie_path', DIR_WS_ADMIN);
{code}

<p>to:</p>

{code}
ini_set('session.cookie_path', $cookie_path);
ini_set('session.cookie_domain', $cookie_domain);
{code}

<p><i class="icon-file"></i> <strong>admin/includes/classes/split_page_results.php</strong></p>

<p>around line 58, change from:</p>

{code}
$display_links .= '<a href="' . tep_href_link($PHP_SELF, $parameters . $page_name . '=' . ($current_page_number - 1), 'NONSSL') . '" class="splitPageLink">' . PREVNEXT_BUTTON_PREV . '</a>&nbsp;&nbsp;';
{code}

<p>to:</p>

{code}
$display_links .= '<a href="' . tep_href_link($PHP_SELF, $parameters . $page_name . '=' . ($current_page_number - 1)) . '" class="splitPageLink">' . PREVNEXT_BUTTON_PREV . '</a>&nbsp;&nbsp;';
{code}

<p>around line 66, change from:</p>

{code}
$display_links .= '&nbsp;&nbsp;<a href="' . tep_href_link($PHP_SELF, $parameters . $page_name . '=' . ($current_page_number + 1), 'NONSSL') . '" class="splitPageLink">' . PREVNEXT_BUTTON_NEXT . '</a>';
{code}

<p>to:</p>

{code}
$display_links .= '&nbsp;&nbsp;<a href="' . tep_href_link($PHP_SELF, $parameters . $page_name . '=' . ($current_page_number + 1)) . '" class="splitPageLink">' . PREVNEXT_BUTTON_NEXT . '</a>';
{code}

<p><i class="icon-file"></i> <strong>admin/includes/functions/general.php</strong></p>

<p>around line 27, change from:</p>

{code}
function tep_redirect($url) {
  global $logger;

  if ( (strstr($url, "\n") != false) || (strstr($url, "\r") != false) ) {
    tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'NONSSL', false));
  }

  if ( strpos($url, '&amp;') !== false ) {
    $url = str_replace('&amp;', '&', $url);
  }

  header('Location: ' . $url);

  if (STORE_PAGE_PARSE_TIME == 'true') {
    if (!is_object($logger)) $logger = new logger;
    $logger->timer_stop();
  }

  exit;
}
{code}

<p>to:</p>

{code}
function tep_redirect($url) {
  global $logger;

  if ( (strstr($url, "\n") != false) || (strstr($url, "\r") != false) ) {
    tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'SSL', false));
  }

  if ( strpos($url, '&amp;') !== false ) {
    $url = str_replace('&amp;', '&', $url);
  }

  header('Location: ' . $url);

  if (STORE_PAGE_PARSE_TIME == 'true') {
    if (!is_object($logger)) $logger = new logger;
    $logger->timer_stop();
  }

  exit;
}
{code}

<p>around line 270, change from:</p>

{code}
function tep_info_image($image, $alt, $width = '', $height = '') {
  if (tep_not_null($image) && (file_exists(DIR_FS_CATALOG_IMAGES . $image)) ) {
    $image = tep_image(DIR_WS_CATALOG_IMAGES . $image, $alt, $width, $height);
  } else {
    $image = TEXT_IMAGE_NONEXISTENT;
  }

  return $image;
}
{code}

<p>to:</p>

{code}
function tep_info_image($image, $alt, $width = '', $height = '') {
  if (tep_not_null($image) && (file_exists(DIR_FS_CATALOG_IMAGES . $image)) ) {
    $image = tep_image(HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . $image, $alt, $width, $height);
  } else {
    $image = TEXT_IMAGE_NONEXISTENT;
  }

  return $image;
}
{code}

<p><i class="icon-file"></i> <strong>admin/includes/functions/html_output.php</strong></p>

<p>around line 15, change from:</p>

{code}
function tep_href_link($page = '', $parameters = '', $connection = 'NONSSL') {
  $page = tep_output_string($page);

  if ($page == '') {
    die('</td></tr></table></td></tr></table><br /><br /><font color="#ff0000"><strong>Error!</strong></font><br /><br /><strong>Unable to determine the page link!<br /><br />Function used:<br /><br />tep_href_link(\'' . $page . '\', \'' . $parameters . '\', \'' . $connection . '\')</strong>');
  }
  if ($connection == 'NONSSL') {
    $link = HTTP_SERVER . DIR_WS_ADMIN;
  } elseif ($connection == 'SSL') {
    if (ENABLE_SSL_CATALOG == 'true') {
      $link = HTTPS_SERVER . DIR_WS_ADMIN;
    } else {
      $link = HTTP_SERVER . DIR_WS_ADMIN;
    }
  } else {
    die('</td></tr></table></td></tr></table><br /><br /><font color="#ff0000"><strong>Error!</strong></font><br /><br /><strong>Unable to determine connection method on a link!<br /><br />Known methods: NONSSL SSL<br /><br />Function used:<br /><br />tep_href_link(\'' . $page . '\', \'' . $parameters . '\', \'' . $connection . '\')</strong>');
  }
  if ($parameters == '') {
    $link = $link . $page . '?' . SID;
  } else {
    $link = $link . $page . '?' . tep_output_string($parameters) . '&' . SID;
  }

  while ( (substr($link, -1) == '&') || (substr($link, -1) == '?') ) $link = substr($link, 0, -1);

  return $link;
}
{code}

<p>to:</p>

{code}
function tep_href_link($page = '', $parameters = '', $connection = 'SSL', $add_session_id = true) {
  global $request_type;

  $page = tep_output_string($page);

  if ($page == '') {
    die('</td></tr></table></td></tr></table><br /><br /><font color="#ff0000"><strong>Error!</strong></font><br /><br /><strong>Unable to determine the page link!<br /><br />Function used:<br /><br />tep_href_link(\'' . $page . '\', \'' . $parameters . '\', \'' . $connection . '\')</strong>');
  }

  if ($connection == 'NONSSL') {
    $link = HTTP_SERVER . DIR_WS_ADMIN;
  } elseif ($connection == 'SSL') {
    if (ENABLE_SSL == true) {
      $link = HTTPS_SERVER . DIR_WS_HTTPS_ADMIN;
    } else {
      $link = HTTP_SERVER . DIR_WS_ADMIN;
    }
  } else {
    die('</td></tr></table></td></tr></table><br /><br /><font color="#ff0000"><strong>Error!</strong></font><br /><br /><strong>Unable to determine connection method on a link!<br /><br />Known methods: NONSSL SSL<br /><br />Function used:<br /><br />tep_href_link(\'' . $page . '\', \'' . $parameters . '\', \'' . $connection . '\')</strong>');
  }

  if (tep_not_null($parameters)) {
    $link .= $page . '?' . tep_output_string($parameters);
    $separator = '&';
  } else {
    $link .= $page;
    $separator = '?';
  }

  while ( (substr($link, -1) == '&') || (substr($link, -1) == '?') ) $link = substr($link, 0, -1);

// Add the session ID when moving from different HTTP and HTTPS servers, or when SID is defined
  if ( ($add_session_id == true) && (SESSION_FORCE_COOKIE_USE == 'False') ) {
    if (tep_not_null($SID)) {
      $_sid = $SID;
    } elseif ( ( ($request_type == 'NONSSL') && ($connection == 'SSL') && (ENABLE_SSL == true) ) || ( ($request_type == 'SSL') && ($connection == 'NONSSL') ) ) {
      if (HTTP_COOKIE_DOMAIN != HTTPS_COOKIE_DOMAIN) {
        $_sid = tep_session_name() . '=' . tep_session_id();
      }
    }
  }

  if (isset($_sid)) {
    $link .= $separator . tep_output_string($_sid);
  }

  while (strstr($link, '&&')) $link = str_replace('&&', '&', $link);

  return $link;
}
{code}

<p><i class="icon-file"></i> <strong>admin/includes/functions/sessions.php</strong></p>

<p>around line 91, change from:</p>

{code}
if ($sane_session_id == false) {
  tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'NONSSL', false));
}

register_shutdown_function('session_write_close');
{code}

<p>to:</p>

{code}
if ($sane_session_id == false) {
  tep_redirect(tep_href_link(FILENAME_DEFAULT, '', 'SSL', false));
}

register_shutdown_function('session_write_close');
{code}

<p><i class="icon-file"></i> <strong>admin/includes/header.php</strong></p>

<p>around line 20, change from:</p>

{code}
<td colspan="2"><?php echo '<a href="' . tep_href_link(FILENAME_DEFAULT, '', 'NONSSL') . '">' . tep_image(DIR_WS_IMAGES . 'oscommerce.png', 'osCommerce Online Merchant v' . tep_get_version()) . '</a>'; ?></td>
{code}

<p>to:</p>

{code}
<td colspan="2"><?php echo '<a href="' . tep_href_link(FILENAME_DEFAULT) . '">' . tep_image(DIR_WS_IMAGES . 'oscommerce.png', 'osCommerce Online Merchant v' . tep_get_version()) . '</a>'; ?></td>
{code}

<p>around line 23, change from:</p>

{code}
<td class="headerBarContent">&nbsp;&nbsp;<?php echo '<a href="' . tep_href_link(FILENAME_DEFAULT, '', 'NONSSL') . '" class="headerLink">' . HEADER_TITLE_ADMINISTRATION . '</a> &nbsp;|&nbsp; <a href="' . tep_catalog_href_link() . '" class="headerLink">' . HEADER_TITLE_ONLINE_CATALOG . '</a> &nbsp;|&nbsp; <a href="http://www.oscommerce.com" class="headerLink">' . HEADER_TITLE_SUPPORT_SITE . '</a>'; ?></td>
{code}

<p>to:</p>

{code}
<td class="headerBarContent">&nbsp;&nbsp;<?php echo '<a href="' . tep_href_link(FILENAME_DEFAULT) . '" class="headerLink">' . HEADER_TITLE_ADMINISTRATION . '</a> &nbsp;|&nbsp; <a href="' . tep_catalog_href_link() . '" class="headerLink">' . HEADER_TITLE_ONLINE_CATALOG . '</a> &nbsp;|&nbsp; <a href="http://www.oscommerce.com" class="headerLink">' . HEADER_TITLE_SUPPORT_SITE . '</a>'; ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/includes/modules/security_check/extended/admin_backup_directory_listing.php</strong></p>

<p>around line 26, change from:</p>

{code}
$request = $this->getHttpRequest(tep_href_link('backups/', '', 'NONSSL'));
{code}

<p>to:</p>

{code}
$request = $this->getHttpRequest(tep_href_link('backups/'));
{code}

<p><i class="icon-file"></i> <strong>admin/includes/modules/security_check/extended/admin_backup_file.php</strong></p>

<p>around line 57, change from:</p>

{code}
$request = $this->getHttpRequest(tep_href_link('backups/' . $backup_file, '', 'NONSSL'));
{code}

<p>to:</p>

{code}
$request = $this->getHttpRequest(tep_href_link('backups/' . $backup_file));
{code}

<p><i class="icon-file"></i> <strong>admin/includes/modules/security_check/extended/ext_directory_listing.php</strong></p>

<p>around line 26, change from:</p>

{code}
$request = $this->getHttpRequest(tep_catalog_href_link('ext/', '', 'NONSSL'));
{code}

<p>to:</p>

{code}
$request = $this->getHttpRequest(tep_catalog_href_link('ext/'));
{code}

<p><i class="icon-file"></i> <strong>admin/includes/template_top.php</strong></p>

<p>around line 19, change from:</p>

{code}
<base href="<?php echo HTTP_SERVER . DIR_WS_ADMIN; ?>" />
<!--[if IE]><script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/excanvas.min.js'); ?>"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="<?php echo tep_catalog_href_link('ext/jquery/ui/redmond/jquery-ui-1.10.4.min.css'); ?>">
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/jquery-1.11.1.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/ui/jquery-ui-1.10.4.min.js'); ?>"></script>
{code}

<p>to:</p>

{code}
<base href="<?php echo ($request_type == 'SSL') ? HTTPS_SERVER . DIR_WS_HTTPS_ADMIN : HTTP_SERVER . DIR_WS_ADMIN; ?>" />
<!--[if IE]><script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/excanvas.min.js', '', 'SSL'); ?>"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="<?php echo tep_catalog_href_link('ext/jquery/ui/redmond/jquery-ui-1.10.4.min.css', '', 'SSL'); ?>">
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/jquery-1.11.1.min.js', '', 'SSL'); ?>"></script>
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/ui/jquery-ui-1.10.4.min.js', '', 'SSL'); ?>"></script>
{code}

<p>around line 28, change from:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/ui/i18n/jquery.ui.datepicker-' . JQUERY_DATEPICKER_I18N_CODE . '.js'); ?>"></script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/jquery/ui/i18n/jquery.ui.datepicker-' . JQUERY_DATEPICKER_I18N_CODE . '.js', '', 'SSL'); ?>"></script>
{code}

<p>around line 36, change from:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.time.min.js'); ?>"></script>
{code}

<p>to:</p>

{code}
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.min.js', '', 'SSL'); ?>"></script>
<script type="text/javascript" src="<?php echo tep_catalog_href_link('ext/flot/jquery.flot.time.min.js', '', 'SSL'); ?>"></script>
{code}

<p><i class="icon-file"></i> <strong>admin/invoice.php</strong></p>

<p>around line 39, change from:</p>

{code}
<td class="pageHeading" align="right"><?php echo tep_image(DIR_WS_CATALOG_IMAGES . 'store_logo.png', STORE_NAME); ?></td>
{code}

<p>to:</p>

{code}
<td class="pageHeading" align="right"><?php echo tep_image(HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . 'store_logo.png', STORE_NAME); ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/packingslip.php</strong></p>

<p>around line 38, change from:</p>

{code}
<td class="pageHeading" align="right"><?php echo tep_image(DIR_WS_CATALOG_IMAGES . 'store_logo.png', STORE_NAME); ?></td>
{code}

<p>to:</p>

{code}
<td class="pageHeading" align="right"><?php echo tep_image(HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . 'store_logo.png', STORE_NAME); ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/products_attributes.php</strong></p>

<p>around line 207, change from:</p>

{code}
<td align="right" colspan="3" class="smallText"><br /><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="right" colspan="3" class="smallText"><br /><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 216, change from:</p>

{code}
<td class="smallText" align="right" colspan="3"><br /><?php echo tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_option&option_id=' . $HTTP_GET_VARS['option_id'] . '&' . $page_info, 'NONSSL'), 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td class="smallText" align="right" colspan="3"><br /><?php echo tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_option&option_id=' . $HTTP_GET_VARS['option_id'] . '&' . $page_info), 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 260, change from:</p>

{code}
echo '<form name="option" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_option_name&' . $page_info, 'NONSSL') . '" method="post">';
{code}

<p>to:</p>

{code}
echo '<form name="option" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_option_name&' . $page_info) . '" method="post">';
{code}

<p>around line 270, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_SAVE, 'disk', null, 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_SAVE, 'disk', null, 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 277, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_EDIT, 'document', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_option&option_id=' . $options_values['products_options_id'] . '&' . $page_info, 'NONSSL')) . tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_product_option&option_id=' . $options_values['products_options_id'] . '&' . $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_EDIT, 'document', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_option&option_id=' . $options_values['products_options_id'] . '&' . $page_info)) . tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_product_option&option_id=' . $options_values['products_options_id'] . '&' . $page_info)); ?>&nbsp;</td>
{code}

<p>around line 296, change from:</p>

{code}
echo '<form name="options" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=add_product_options&' . $page_info, 'NONSSL') . '" method="post"><input type="hidden" name="products_options_id" value="' . $next_id . '">';
{code}

<p>to:</p>

{code}
echo '<form name="options" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=add_product_options&' . $page_info) . '" method="post"><input type="hidden" name="products_options_id" value="' . $next_id . '">';
{code}

<p>around line 364, change from:</p>

{code}
<td class="smallText" align="right" colspan="3"><br /><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td class="smallText" align="right" colspan="3"><br /><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 373, change from:</p>

{code}
<td class="smallText" align="right" colspan="3"><br /><?php echo tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_value&value_id=' . $HTTP_GET_VARS['value_id'] . '&' . $page_info, 'NONSSL'), 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td class="smallText" align="right" colspan="3"><br /><?php echo tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_value&value_id=' . $HTTP_GET_VARS['value_id'] . '&' . $page_info), 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 420, change from:</p>

{code}
echo '<form name="values" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_value&' . $page_info, 'NONSSL') . '" method="post">';
{code}

<p>to:</p>

{code}
echo '<form name="values" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_value&' . $page_info) . '" method="post">';
{code}

<p>around line 442, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_SAVE, 'disk', null, 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_SAVE, 'disk', null, 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 450, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_EDIT, 'document', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_option_value&value_id=' . $values_values['products_options_values_id'] . '&' . $page_info, 'NONSSL')) . tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_option_value&value_id=' . $values_values['products_options_values_id'] . '&' . $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_EDIT, 'document', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_option_value&value_id=' . $values_values['products_options_values_id'] . '&' . $page_info)) . tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_option_value&value_id=' . $values_values['products_options_values_id'] . '&' . $page_info)); ?>&nbsp;</td>
{code}

<p>around line 467, change from:</p>

{code}
echo '<form name="values" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=add_product_option_values&' . $page_info, 'NONSSL') . '" method="post">';
{code}

<p>to:</p>

{code}
echo '<form name="values" action="' . tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=add_product_option_values&' . $page_info) . '" method="post">';
{code}

<p>around line 600, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_SAVE, 'disk', null, 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_SAVE, 'disk', null, 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 643, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_attribute&attribute_id=' . $HTTP_GET_VARS['attribute_id'] . '&' . $page_info), 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_attribute&attribute_id=' . $HTTP_GET_VARS['attribute_id'] . '&' . $page_info), 'primary') . tep_draw_button(IMAGE_CANCEL, 'close', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, $page_info)); ?>&nbsp;</td>
{code}

<p>around line 653, change from:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_EDIT, 'document', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_attribute&attribute_id=' . $attributes_values['products_attributes_id'] . '&' . $page_info, 'NONSSL')) . tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_product_attribute&attribute_id=' . $attributes_values['products_attributes_id'] . '&' . $page_info, 'NONSSL')); ?>&nbsp;</td>
{code}

<p>to:</p>

{code}
<td align="center" class="smallText">&nbsp;<?php echo tep_draw_button(IMAGE_EDIT, 'document', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=update_attribute&attribute_id=' . $attributes_values['products_attributes_id'] . '&' . $page_info)) . tep_draw_button(IMAGE_DELETE, 'trash', tep_href_link(FILENAME_PRODUCTS_ATTRIBUTES, 'action=delete_product_attribute&attribute_id=' . $attributes_values['products_attributes_id'] . '&' . $page_info)); ?>&nbsp;</td>
{code}

<p><i class="icon-file"></i> <strong>admin/reviews.php</strong></p>

<p>around line 161, change from:</p>

{code}
<td class="main"><strong><?php echo ENTRY_RATING; ?></strong>&nbsp;<?php echo tep_image(DIR_WS_CATALOG_IMAGES . 'stars_' . $rInfo->reviews_rating . '.gif', sprintf(TEXT_OF_5_STARS, $rInfo->reviews_rating)); ?>&nbsp;<small>[<?php echo sprintf(TEXT_OF_5_STARS, $rInfo->reviews_rating); ?>]</small></td>
{code}

<p>to:</p>

{code}
<td class="main"><strong><?php echo ENTRY_RATING; ?></strong>&nbsp;<?php echo tep_image(HTTP_CATALOG_SERVER . DIR_WS_CATALOG_IMAGES . 'stars_' . $rInfo->reviews_rating . '.gif', sprintf(TEXT_OF_5_STARS, $rInfo->reviews_rating)); ?>&nbsp;<small>[<?php echo sprintf(TEXT_OF_5_STARS, $rInfo->reviews_rating); ?>]</small></td>
{code}

<p>around line 186, change from:</p>

{code}
<td align="right" class="smallText"><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link($back_url, $back_url_params, 'NONSSL')); ?></td>
{code}

<p>to:</p>

{code}
<td align="right" class="smallText"><?php echo tep_draw_button(IMAGE_BACK, 'triangle-1-w', tep_href_link($back_url, $back_url_params)); ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/specials.php</strong></p>

<p>around line 25, change from:</p>

{code}
tep_redirect(tep_href_link(FILENAME_SPECIALS, (isset($HTTP_GET_VARS['page']) ? 'page=' . $HTTP_GET_VARS['page'] . '&' : '') . 'sID=' . $HTTP_GET_VARS['id'], 'NONSSL'));
{code}

<p>to:</p>

{code}
tep_redirect(tep_href_link(FILENAME_SPECIALS, (isset($HTTP_GET_VARS['page']) ? 'page=' . $HTTP_GET_VARS['page'] . '&' : '') . 'sID=' . $HTTP_GET_VARS['id']));
{code}

<p>around line 111, change from:</p>

{code}
<tr><form name="new_special" action="<?php echo tep_href_link(FILENAME_SPECIALS, tep_get_all_get_params(array('action', 'info', 'sID')) . 'action=' . $form_action, 'NONSSL'); ?>" method="post"><?php if ($form_action == 'update') echo tep_draw_hidden_field('specials_id', $HTTP_GET_VARS['sID']); ?>
{code}

<p>to:</p>

{code}
<tr><form name="new_special" action="<?php echo tep_href_link(FILENAME_SPECIALS, tep_get_all_get_params(array('action', 'info', 'sID')) . 'action=' . $form_action); ?>" method="post"><?php if ($form_action == 'update') echo tep_draw_hidden_field('specials_id', $HTTP_GET_VARS['sID']); ?>
{code}

<!-- HPDL: The above change on line 111 has been slightly altered to preserve syntax coloring in prismjs //-->

<p>around line 179, change from:</p>

{code}
echo tep_image(DIR_WS_IMAGES . 'icon_status_green.gif', IMAGE_ICON_STATUS_GREEN, 10, 10) . '&nbsp;&nbsp;<a href="' . tep_href_link(FILENAME_SPECIALS, 'action=setflag&flag=0&id=' . $specials['specials_id'], 'NONSSL') . '">' . tep_image(DIR_WS_IMAGES . 'icon_status_red_light.gif', IMAGE_ICON_STATUS_RED_LIGHT, 10, 10) . '</a>';
{code}

<p>to:</p>

{code}
echo tep_image(DIR_WS_IMAGES . 'icon_status_green.gif', IMAGE_ICON_STATUS_GREEN, 10, 10) . '&nbsp;&nbsp;<a href="' . tep_href_link(FILENAME_SPECIALS, 'action=setflag&flag=0&id=' . $specials['specials_id']) . '">' . tep_image(DIR_WS_IMAGES . 'icon_status_red_light.gif', IMAGE_ICON_STATUS_RED_LIGHT, 10, 10) . '</a>';
{code}

<p>around line 181, change from:</p>

{code}
echo '<a href="' . tep_href_link(FILENAME_SPECIALS, 'action=setflag&flag=1&id=' . $specials['specials_id'], 'NONSSL') . '">' . tep_image(DIR_WS_IMAGES . 'icon_status_green_light.gif', IMAGE_ICON_STATUS_GREEN_LIGHT, 10, 10) . '</a>&nbsp;&nbsp;' . tep_image(DIR_WS_IMAGES . 'icon_status_red.gif', IMAGE_ICON_STATUS_RED, 10, 10);
{code}

<p>to:</p>

{code}
echo '<a href="' . tep_href_link(FILENAME_SPECIALS, 'action=setflag&flag=1&id=' . $specials['specials_id']) . '">' . tep_image(DIR_WS_IMAGES . 'icon_status_green_light.gif', IMAGE_ICON_STATUS_GREEN_LIGHT, 10, 10) . '</a>&nbsp;&nbsp;' . tep_image(DIR_WS_IMAGES . 'icon_status_red.gif', IMAGE_ICON_STATUS_RED, 10, 10);
{code}

<p><i class="icon-file"></i> <strong>admin/stats_customers.php</strong></p>

<p>around line 56, change from:</p>

{code}
<tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href='<?php echo tep_href_link(FILENAME_CUSTOMERS, 'search=' . $customers['customers_lastname'], 'NONSSL'); ?>'">
{code}

<p>to:</p>

{code}
<tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href='<?php echo tep_href_link(FILENAME_CUSTOMERS, 'search=' . $customers['customers_lastname']); ?>'">
{code}

<p>around line 58, change from:</p>

{code}
<td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_CUSTOMERS, 'search=' . $customers['customers_lastname'], 'NONSSL') . '">' . $customers['customers_firstname'] . ' ' . $customers['customers_lastname'] . '</a>'; ?></td>
{code}

<p>to:</p>

{code}
<td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_CUSTOMERS, 'search=' . $customers['customers_lastname']) . '">' . $customers['customers_firstname'] . ' ' . $customers['customers_lastname'] . '</a>'; ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/stats_products_purchased.php</strong></p>

<p>around line 50, change from:</p>

{code}
<tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href='<?php echo tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_PURCHASED . '?page=' . $HTTP_GET_VARS['page'], 'NONSSL'); ?>'">
{code}

<p>to:</p>

{code}
<tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href='<?php echo tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_PURCHASED . '?page=' . $HTTP_GET_VARS['page']); ?>'">
{code}

<p>around line 52, change from:</p>

{code}
<td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_PURCHASED . '?page=' . $HTTP_GET_VARS['page'], 'NONSSL') . '">' . $products['products_name'] . '</a>'; ?></td>
{code}

<p>to:</p>

{code}
<td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_PURCHASED . '?page=' . $HTTP_GET_VARS['page']) . '">' . $products['products_name'] . '</a>'; ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/stats_products_viewed.php</strong></p>

<p>around line 49, change from:</p>

{code}
<tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href='<?php echo tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_VIEWED . '?page=' . $HTTP_GET_VARS['page'], 'NONSSL'); ?>'">
{code}

<p>to:</p>

{code}
<tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href='<?php echo tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_VIEWED . '?page=' . $HTTP_GET_VARS['page']); ?>'">
{code}

<p>around line 51, change from:</p>

{code}
<td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_VIEWED . '?page=' . $HTTP_GET_VARS['page'], 'NONSSL') . '">' . $products['products_name'] . '</a> (' . $products['name'] . ')'; ?></td>
{code}

<p>to:</p>

{code}
<td class="dataTableContent"><?php echo '<a href="' . tep_href_link(FILENAME_CATEGORIES, 'action=new_product_preview&read=only&pID=' . $products['products_id'] . '&origin=' . FILENAME_STATS_PRODUCTS_VIEWED . '?page=' . $HTTP_GET_VARS['page']) . '">' . $products['products_name'] . '</a> (' . $products['name'] . ')'; ?></td>
{code}

<p><i class="icon-file"></i> <strong>admin/whos_online.php</strong></p>

<p>around line 59, change from:</p>

{code}
echo '              <tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href=\'' . tep_href_link(FILENAME_WHOS_ONLINE, tep_get_all_get_params(array('info', 'action')) . 'info=' . $whos_online['session_id'], 'NONSSL') . '\'">' . "\n";
{code}

<p>to:</p>

{code}
echo '              <tr class="dataTableRow" onmouseover="rowOverEffect(this)" onmouseout="rowOutEffect(this)" onclick="document.location.href=\'' . tep_href_link(FILENAME_WHOS_ONLINE, tep_get_all_get_params(array('info', 'action')) . 'info=' . $whos_online['session_id']) . '\'">' . "\n";
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/cf22a7ba4c1cffa0dc55f0e80e4c1d11fa001c34" target="_blank">View online at GitHub</a></p>

<span id="upg15"></span>

<h3 class="notoc">Content Modules (6+ files)</h3>

<p>This changeset introduces a new Content Modules implementation where the content of a page is loaded through modules. This is introduced for the Login, My Account, and Checkout Success pages.</p>

<div class="note">Although it is easy to add support for Content Modules to existing stores, updating the Login, My Account, and Checkout Success pages will be harder and require further source code changes the more customized those pages are. Please consult with your developer, our partners, or our community forum on how to best integrate the Content Modules feature into your existing pages.</div>

<h4 class="notoc">Step 1: Content Modules Administration Page</h4>

<p>Step 1 adds the content modules administration page to the Administration Tool -> Modules menu.</p>

<p>Copy the following files to their respective destination:</p>

<p>
  <i class="icon-file"></i> <strong>admin/includes/boxes/modules_content.php</strong><br />
  <i class="icon-file"></i> <strong>admin/includes/languages/english/modules/boxes/modules_content.php</strong><br />
  <i class="icon-file"></i> <strong>admin/includes/languages/english/modules_content.php</strong><br />
  <i class="icon-file"></i> <strong>admin/modules_content.php</strong>
</p>

<div class="info">Please copy the english language definition files to the other language directories you have installed and update the definitions for that specific language.</div>

<h4 class="notoc">Step 2: Content Modules</h4>

<p>Step 2 adds the actual content modules to your store installation.</p>

<p>Copy the following directories to their respective destination:</p>

<p>
  <i class="icon-folder-open"></i> <strong>ext/modules/content</strong><br />
  <i class="icon-folder-open"></i> <strong>includes/languages/english/modules/content</strong><br />
  <i class="icon-folder-open"></i> <strong>includes/modules/content</strong><br />
  <i class="icon-folder-open"></i> <strong>includes/modules/pages</strong>
</p>

<div class="info">Please copy the english language definition files to the other language directories you have installed and update the definitions for that specific language.</div>

<p>This adds the following Content Modules which can be installed and configured on the Administration Tool -> Modules -> Content Modules -> Install page:</p>

<ul>
  <li>Account<ul>
    <li>Set Password</li>
    <li><em>Braintree Cards Management Page</em></li>
    <li><em>Sage Pay Cards Management Page</em></li>
    <li><em>Stripe Cards Management Page</em></li>
  </ul></li>
  <li>Checkout Success<ul>
    <li>Downloads</li>
    <li>Product Notifications</li>
    <li>Redirect Old Order</li>
    <li>Thank You</li>
  </ul></li>
  <li>Login<ul>
    <li>Create Account</li>
    <li>Login</li>
    <li><em>Log In with PayPal</em></li>
  </ul></li>
</ul>

<div class="info">The modules that are emphasized are from additional modules included in this release.</div>

<h4 class="notoc">Step 3: Template Class</h4>

<p>Step 3 adds functions to the template class to call and initialize content modules.</p>

<p><i class="icon-file"></i> <strong>includes/classes/osc_template.php</strong></p>

<p>around line 14, change from:</p>

{code}
var $_title;
var $_blocks = array();
var $_grid_container_width = 24;
var $_grid_content_width = 16;
var $_grid_column_width = 4;
{code}

<p>to:</p>

{code}
var $_title;
var $_blocks = array();
var $_content = array();
var $_grid_container_width = 24;
var $_grid_content_width = 16;
var $_grid_column_width = 4;
var $_data = array();
{code}

<p>around line 110, add the following class functions:</p>

{code}
function addContent($content, $group) {
  $this->_content[$group][] = $content;
}

function hasContent($group) {
  return (isset($this->_content[$group]) && !empty($this->_content[$group]));
}

function getContent($group) {
  global $language;

  if ( !class_exists('tp_' . $group) && file_exists(DIR_WS_MODULES . 'pages/tp_' . $group . '.php') ) {
    include(DIR_WS_MODULES . 'pages/tp_' . $group . '.php');
  }

  if ( class_exists('tp_' . $group) ) {
    $template_page_class = 'tp_' . $group;
    $template_page = new $template_page_class();
    $template_page->prepare();
  }

  foreach ( $this->getContentModules($group) as $module ) {
    if ( !class_exists($module) ) {
      if ( file_exists(DIR_WS_MODULES . 'content/' . $group . '/' . $module . '.php') ) {
        if ( file_exists(DIR_WS_LANGUAGES . $language . '/modules/content/' . $group . '/' . $module . '.php') ) {
          include(DIR_WS_LANGUAGES . $language . '/modules/content/' . $group . '/' . $module . '.php');
        }

        include(DIR_WS_MODULES . 'content/' . $group . '/' . $module . '.php');
      }
    }

    if ( class_exists($module) ) {
      $mb = new $module();

      if ( $mb->isEnabled() ) {
        $mb->execute();
      }
    }
  }

  if ( class_exists('tp_' . $group) ) {
    $template_page->build();
  }

  if ($this->hasContent($group)) {
    return implode("\n", $this->_content[$group]);
  }
}

function getContentModules($group) {
  $result = array();

  foreach ( explode(';', MODULE_CONTENT_INSTALLED) as $m ) {
    $module = explode('/', $m, 2);

    if ( $module[0] == $group ) {
      $result[] = $module[1];
    }
  }

  return $result;
}
{code}

<h4 class="notoc">Step 4: Page Updates</h4>

<p>Step 4 updates the Login, My Account, and Checkout Success pages to use the installed and configured Content Modules for the page layout.</p>

<h5 class="notoc">Login Page</h5>

<p><i class="icon-file"></i> <strong>login.php</strong></p>

<p>The code authenticating the customer and presenting the login form and create account link have moved from the login.php page to the Login Form and Create Account Link Content Modules. Due to the source code changes involved and possible customizations applied to your login page, it is recommended to review and compare your login.php page with the v2.3.4 version and apply any customizations in the login process to the Login Form Content Module.</p>

<p>The Login Form Content Module assigns the global $login_customer_id variable with the customer ID when the customer has been successfully authenticated. This value is then detected in the login.php page and continues to log the customer into their session.</p>

<p>The location of the Login Form Content Module files are at:</p>

<ul>
  <li>includes/languages/english/modules/content/login/cm_login_form.php <em>(language definitions)</em></li>
  <li>includes/modules/content/login/cm_login_form.php <em>(main class which authenticates the customer)</em></li>
  <li>includes/modules/content/login/templates/login_form.php <em>(template)</em></li>
</ul>

<p>The location of the Create Account Link Content Module files are at:</p>

<ul>
  <li>includes/languages/english/modules/content/login/cm_create_account_link.php <em>(language definitions)</em></li>
  <li>includes/modules/content/login/cm_create_account_link.php <em>(main class)</em></li>
  <li>includes/modules/content/login/templates/create_account_link.php <em>(template)</em></li>
</ul>

<p>The login.php file included in v2.3.4 can be found at:</p>

<p><a href="https://github.com/osCommerce/oscommerce2/blob/f396c33ae52b11c691ae1fcae9fa17efac785bb7/catalog/login.php" target="_blank">https://github.com/osCommerce/oscommerce2/blob/3eaa3d1d0e9646329a1540bc3b63c192b4306f1c/catalog/login.php</a></p>

<p><i class="icon-file"></i> <strong>includes/languages/english/login.php</strong></p>

<p>The following language definitions have moved and have been replaced by definitions in the Content Modules.</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Old Definition</th>
      <th>Content Module</th>
      <th>New Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>HEADING_NEW_CUSTOMER</td>
      <td>Create Account Link</td>
      <td>MODULE_CONTENT_LOGIN_HEADING_NEW_CUSTOMER</td>
    </tr>
    <tr>
      <td>TEXT_NEW_CUSTOMER</td>
      <td>Create Account Link</td>
      <td>MODULE_CONTENT_LOGIN_TEXT_NEW_CUSTOMER</td>
    </tr>
    <tr>
      <td>TEXT_NEW_CUSTOMER_INTRODUCTION</td>
      <td>Create Account Link</td>
      <td>MODULE_CONTENT_LOGIN_TEXT_NEW_CUSTOMER_INTRODUCTION</td>
    </tr>
    <tr>
      <td>HEADING_RETURNING_CUSTOMER</td>
      <td>Login Form</td>
      <td>MODULE_CONTENT_LOGIN_HEADING_RETURNING_CUSTOMER</td>
    </tr>
    <tr>
      <td>TEXT_RETURNING_CUSTOMER</td>
      <td>Login Form</td>
      <td>MODULE_CONTENT_LOGIN_TEXT_RETURNING_CUSTOMER</td>
    </tr>
    <tr>
      <td>TEXT_PASSWORD_FORGOTTEN</td>
      <td>Login Form</td>
      <td>MODULE_CONTENT_LOGIN_TEXT_PASSWORD_FORGOTTEN</td>
    </tr>
    <tr>
      <td>TEXT_LOGIN_ERROR</td>
      <td>Login Form</td>
      <td>MODULE_CONTENT_LOGIN_TEXT_LOGIN_ERROR</td>
    </tr>
  </tbody>
</table>

<h5 class="notoc">My Account Page</h5>

<p><i class="icon-file"></i> <strong>account.php</strong></p>

<p>The structured links shown on the My Account page are now generated from an array which Content Modules can manipulate. Content Modules can add new sections to the My Account page, add links to existing sections, and also remove or replace links in special occassions.</p>

<p>The standard links for the My Account page are defined in a Content Module Page class which the My Account Content Modules have access to.</p>

<p>The location of the My Account Content Module Page class is at:</p>

<ul>
  <li>includes/modules/pages/tp_account.php</li>
</ul>

<p>The standard links for the My Account page include:</p>

<ul>
  <li>My Account<ul>
    <li>Edit Account</li>
    <li>Address Book</li>
    <li>Change Password</li>
  </ul></li>
  <li>Orders<ul>
    <li>Order History</li>
  </ul></li>
  <li>Notifications<ul>
    <li>Newsletters</li>
    <li>Product Notifications</li>
  </ul></li>
</ul>

<p>This release introduces a My Account Set Password Content Module that automatically replaces the Change Password link to a Set Password link for accounts that have been created without a password (eg, accounts created through Log In with PayPal or when guests purchase an order with PayPal Express Checkout).</p>

<p>The account.php file included in v2.3.4 can be found at:</p>

<p><a href="https://github.com/osCommerce/oscommerce2/blob/f396c33ae52b11c691ae1fcae9fa17efac785bb7/catalog/account.php" target="_blank">https://github.com/osCommerce/oscommerce2/blob/3eaa3d1d0e9646329a1540bc3b63c192b4306f1c/catalog/account.php</a></p>

<h5 class="notoc">Checkout Success Page</h5>

<p><i class="icon-file"></i> <strong>checkout_success.php</strong></p>

<p>The content of the checkout success page has moved and is now built with the following Content Modules:</p>

<ul>
  <li>Thank You</li>
  <li>Product Notifications</li>
  <li>Downloads</li>
</ul>

<p>The checkout success page assigns the global $order_id variable with the order ID of the customers last order which the Checkout Success Content Modules have access to.</p>

<p>The location of the Thank You Content Module files are at:</p>

<ul>
  <li>includes/languages/english/modules/content/checkout_success/cm_cs_thank_you.php <em>(language definitions)</em></li>
  <li>includes/modules/content/checkout_success/cm_cs_thank_you.php <em>(main class)</em></li>
  <li>includes/modules/content/checkout_success/templates/thank_you.php <em>(template)</em></li>
</ul>

<p>The location of the Product Notifications Content Module files are at:</p>

<ul>
  <li>includes/languages/english/modules/content/checkout_success/cm_cs_product_notifications.php <em>(language definitions)</em></li>
  <li>includes/modules/content/checkout_success/cm_cs_product_notifications.php <em>(main class)</em></li>
  <li>includes/modules/content/checkout_success/templates/product_notifications.php <em>(template)</em></li>
</ul>

<p>The location of the Downloads Content Module files are at:</p>

<ul>
  <li>includes/languages/english/modules/content/checkout_success/cm_cs_downloads.php <em>(language definitions)</em></li>
  <li>includes/modules/content/checkout_success/cm_cs_downloads.php <em>(main class)</em></li>
</ul>

<p>The checkout_success.php file included in v2.3.4 can be found at:</p>

<p><a href="https://github.com/osCommerce/oscommerce2/blob/f396c33ae52b11c691ae1fcae9fa17efac785bb7/catalog/checkout_success.php" target="_blank">https://github.com/osCommerce/oscommerce2/blob/3eaa3d1d0e9646329a1540bc3b63c192b4306f1c/catalog/checkout_success.php</a></p>

<p><i class="icon-file"></i> <strong>includes/languages/english/checkout_success.php</strong></p>

<p>The following language definitions have moved and have been replaced by definitions in the Content Modules.</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Old Definition</th>
      <th>Content Module</th>
      <th>New Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>TEXT_SUCCESS</td>
      <td>Thank You</td>
      <td>MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_SUCCESS</td>
    </tr>
    <tr>
      <td>TEXT_SEE_ORDERS</td>
      <td>Thank You</td>
      <td>MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_SEE_ORDERS</td>
    </tr>
    <tr>
      <td>TEXT_CONTACT_STORE_OWNER</td>
      <td>Thank You</td>
      <td>MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_CONTACT_STORE_OWNER</td>
    </tr>
    <tr>
      <td>TEXT_THANKS_FOR_SHOPPING</td>
      <td>Thank You</td>
      <td>MODULE_CONTENT_CHECKOUT_SUCCESS_TEXT_THANKS_FOR_SHOPPING</td>
    </tr>
    <tr>
      <td>TEXT_NOTIFY_PRODUCTS</td>
      <td>Product Notifications</td>
      <td>MODULE_CONTENT_CHECKOUT_SUCCESS_PRODUCT_NOTIFICATIONS_TEXT_NOTIFY_PRODUCTS</td>
    </tr>
    <tr>
      <td>TABLE_HEADING_DOWNLOAD_DATE</td>
      <td>Downloads</td>
      <td>TABLE_HEADING_DOWNLOAD_DATE</td>
    </tr>
    <tr>
      <td>TABLE_HEADING_DOWNLOAD_COUNT</td>
      <td>Downloads</td>
      <td>TABLE_HEADING_DOWNLOAD_COUNT</td>
    </tr>
    <tr>
      <td>HEADING_DOWNLOAD</td>
      <td>Downloads</td>
      <td>HEADING_DOWNLOAD</td>
    </tr>
    <tr>
      <td>FOOTER_DOWNLOAD</td>
      <td>Downloads</td>
      <td>FOOTER_DOWNLOAD</td>
    </tr>
  </tbody>
</table>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/f396c33ae52b11c691ae1fcae9fa17efac785bb7" target="_blank">View online at GitHub</a></p>

<span id="upg16"></span>

<h3 class="notoc">Version Update (1 file)</h3>

<p>This changeset updates the version file.</p>

<p><i class="icon-file"></i> <strong>includes/version.php</strong></p>

<p>change line 1 from:</p>

{code}
2.3.3.4
{code}

<p>to:</p>

{code}
2.3.4
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/fdd55784bd077d0f0ae1336def10b494f712bf2b" target="_blank">View online at GitHub</a></p>

<span id="upg17"></span>

<h3 class="notoc">Administration Dashboard Latest News and Add-Ons (4+ files)</h3>

<p>This changeset updates the Administration Tool Dashboard Latest News and Latest Add-Ons modules.</p>

<p>Copy the following files and directories to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>admin/images/icon_facebook.png</strong><br />
  <i class="icon-file"></i> <strong>admin/images/icon_google_plus.png</strong><br />
  <i class="icon-file"></i> <strong>admin/images/icon_oscommerce.png</strong><br />
  <i class="icon-file"></i> <strong>admin/images/icon_twitter.png</strong><br />
  <i class="icon-file"></i> <strong>admin/includes/languages/english/modules/dashboard/d_latest_addons.php</strong><br />
  <i class="icon-file"></i> <strong>admin/includes/languages/english/modules/dashboard/d_latest_news.php</strong><br />
  <i class="icon-file"></i> <strong>admin/includes/modules/dashboard/d_latest_addons.php</strong><br />
  <i class="icon-file"></i> <strong>admin/includes/modules/dashboard/d_latest_news.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<div class="info">It is safe to overwrite existing files with the new version.</div>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/5ed4e0cde6e64c136ba65d58a663ab1ff30bb69c" target="_blank">View online at GitHub</a></p>

<span id="upg18"></span>

<h3 class="notoc">Administration Tool Orders Box (3 files)</h3>

<p>This changeset moves the Administration Tool -> Customers -> Orders page into a new Administration Tool -> Orders section.</p>

<p>Copy the following files and directories to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>admin/includes/boxes/orders.php</strong>
</p>

<p>In:</p>

<p><i class="icon-file"></i> <strong>admin/includes/boxes/customers.php</strong></p>

<p>around line 20, remove the following lines:</p>

{code}
),
array(
  'code' => FILENAME_ORDERS,
  'title' => BOX_CUSTOMERS_ORDERS,
  'link' => tep_href_link(FILENAME_ORDERS)
{code}

<p><i class="icon-file"></i> <strong>admin/includes/languages/english.php</strong></p>

<p>around line 20, change from:</p>

{code}
define('BOX_CUSTOMERS_ORDERS', 'Orders');
{code}

<p>to:</p>

{code}
// orders box text in includes/boxes/orders.php
define('BOX_HEADING_ORDERS', 'Orders');
define('BOX_ORDERS_ORDERS', 'Orders');
{code}

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/b97ed0bf7d7aaffca329cbeb46e58c7b963058ea" target="_blank">View online at GitHub</a></p>

<span id="upg19"></span>

<h3 class="notoc">Payment Acceptance Box (2+ files)</h3>

<p>This changeset introduces a new Payment Acceptance box that promotes the payment methods accepted on the store.</p>

<p>Copy the following files and directories to their respective directories:</p>

<p>
  <i class="icon-folder-open"></i> <strong>images/card_acceptance</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/boxes/bm_card_acceptance.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/boxes/bm_card_acceptance.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After this changeset is applied, the module can be installed from the Administration Tool -&gt; Modules -&gt; Boxes -> Install page.</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/2a148a182d54a09e54abf298d968cd96552e3b1a" target="_blank">View online at GitHub</a></p>

<span id="upg20"></span>

<h3 class="notoc">PayPal Modules (23 files)</h3>

<p>This changeset updates and introduces new PayPal modules.</p>

<h4 class="notoc">Payment Modules</h4>

<h5 class="notoc">PayPal Express Checkout</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/express.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/paypal_express.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/paypal_express.php</strong>
</p>

<p>Delete the following file:</p>

<p>
  <i class="icon-file"></i> <strong>admin/ext/modules/payment/paypal/paypal_express.php</strong>
</p>

<h5 class="notoc">PayPal Payments Standard</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/standard_ipn.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/paypal_standard.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/paypal_standard.php</strong>
</p>

<h5 class="notoc">PayPal Payments Pro (Direct Payment)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/paypal_pro_dp.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/paypal_pro_dp.php</strong>
</p>

<h5 class="notoc">PayPal Payments Pro (Hosted Solution)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/hosted_checkout.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/images/hss_load.gif</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/pro_hosted_ipn.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/paypal_pro_hs.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/paypal_pro_hs.php</strong>
</p>

<h5 class="notoc">PayPal Express Checkout (Payflow Edition)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/express_payflow.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/paypal_pro_payflow_ec.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/paypal_pro_payflow_ec.php</strong>
</p>

<h5 class="notoc">PayPal Payments Pro (Payflow Edition)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/paypal_pro_payflow_dp.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/paypal_pro_payflow_dp.php</strong><br />
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the modules can be installed from the Administration Tool -&gt; Modules -&gt; Payment -> Install page, or configured from the Administration Tool -> Modules -> Payment page if they were previously installed.</p>

<div class="note">It is important to review the module configuration paramters of modules that were previously installed to make sure new parameters have been configured properly.</div>

<div class="info">It is safe to overwrite existing files with the new version.</div>

<h4 class="notoc">Content Modules</h4>

<h5 class="notoc">Log In with PayPal</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/paypal/paypal.com.crt</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/content/login/cm_paypal_login.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/content/login/cm_paypal_login.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/content/login/templates/paypal_login.php</strong><br />
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the module can be installed from the Administration Tool -&gt; Modules -&gt; Content -> Install page.</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/a425bd8522fd6c6c57785693f44b98330c1da677" target="_blank">View online at GitHub</a></p>

<span id="upg21"></span>

<h3 class="notoc">Sage Pay Modules (12 files)</h3>

<p>This changeset updates and introduces new Sage Pay modules.</p>

<h4 class="notoc">Payment Modules</h4>

<h5 class="notoc">Sage Pay Direct</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/checkout.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/direct_3dauth.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/errors.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/redirect.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/sage_pay_direct.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/sage_pay_direct.php</strong>
</p>

<h5 class="notoc">Sage Pay Form</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/errors.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/sage_pay_form.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/sage_pay_form.php</strong>
</p>

<h5 class="notoc">Sage Pay Server</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/checkout.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/errors.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/redirect.php</strong><br />
  <i class="icon-file"></i> <strong>ext/modules/payment/sage_pay/server.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/sage_pay_server.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/sage_pay_server.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the modules can be installed from the Administration Tool -&gt; Modules -&gt; Payment -> Install page, or configured from the Administration Tool -> Modules -> Payment page if they were previously installed.</p>

<div class="note">It is important to review the module configuration paramters of modules that were previously installed to make sure new parameters have been configured properly.</div>

<div class="info">It is safe to overwrite existing files with the new version.</div>

<h4 class="notoc">Content Modules</h4>

<h5 class="notoc">Sage Pay Cards Management Page</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/content/account/sage_pay/cards.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/content/account/cm_account_sage_pay_cards.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/content/account/cm_account_sage_pay_cards.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the module can be installed from the Administration Tool -&gt; Modules -&gt; Content -> Install page.</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/2ff4689d6067b1f7c6616211484f2887b2b7bd62" target="_blank">View online at GitHub</a></p>

<span id="upg22"></span>

<h3 class="notoc">Authorize.net Modules (7 files)</h3>

<p>This changeset updates and introduces new Authorize.net modules.</p>

<h4 class="notoc">Payment Modules</h4>

<h5 class="notoc">Authorize.net Advanced Integration Method (AIM)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/authorizenet/authorize.net.crt</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/authorizenet_cc_aim.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/authorizenet_cc_aim.php</strong>
</p>

<h5 class="notoc">Authorize.net Server Integration Method (SIM)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/authorizenet_cc_sim.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/authorizenet_cc_sim.php</strong>
</p>

<h5 class="notoc">Authorize.net Direct Post Method (DPM)</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/authorizenet_cc_dpm.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/authorizenet_cc_dpm.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the modules can be installed from the Administration Tool -&gt; Modules -&gt; Payment -> Install page, or configured from the Administration Tool -> Modules -> Payment page if they were previously installed.</p>

<div class="note">It is important to review the module configuration paramters of modules that were previously installed to make sure new parameters have been configured properly.</div>

<div class="info">It is safe to overwrite existing files with the new version.</div>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/8672552b6af846f40c55b77def05bf086a5b0a23" target="_blank">View online at GitHub</a></p>

<span id="upg23"></span>

<h3 class="notoc">Stripe Modules (5 files)</h3>

<p>This changeset introduces new Stripe modules.</p>

<h4 class="notoc">Payment Modules</h4>

<h5 class="notoc">Stripe.js</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/stripe.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/stripe.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the modules can be installed from the Administration Tool -&gt; Modules -&gt; Payment -> Install page, or configured from the Administration Tool -> Modules -> Payment page if they were previously installed.</p>

<h4 class="notoc">Content Modules</h4>

<h5 class="notoc">Stripe Cards Management Page</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/content/account/stripe/cards.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/content/account/cm_account_stripe_cards.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/content/account/cm_account_stripe_cards.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the module can be installed from the Administration Tool -&gt; Modules -&gt; Content -> Install page.</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/64e00aabce698cf797470611b6268f91def45a37" target="_blank">View online at GitHub</a></p>

<span id="upg24"></span>

<h3 class="notoc">Braintree Modules (5+ files)</h3>

<p>This changeset introduces new Braintree modules.</p>

<h4 class="notoc">Payment Modules</h4>

<h5 class="notoc">Braintree</h5>

<p>Copy the following files and directories to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/braintree_cc.php</strong><br />
  <i class="icon-folder-open"></i> <strong>includes/modules/payment/braintree_cc</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/braintree_cc.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the modules can be installed from the Administration Tool -&gt; Modules -&gt; Payment -> Install page, or configured from the Administration Tool -> Modules -> Payment page if they were previously installed.</p>

<h4 class="notoc">Content Modules</h4>

<h5 class="notoc">Braintree Cards Management Page</h5>

<p>Copy the following files to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/content/account/braintree/cards.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/content/account/cm_account_braintree_cards.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/content/account/cm_account_braintree_cards.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the module can be installed from the Administration Tool -&gt; Modules -&gt; Content -> Install page.</p>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/953474e01ed329643a1e9a9c47f87f785edc5b3c" target="_blank">View online at GitHub</a></p>

<span id="upg25"></span>

<h3 class="notoc">WorldPay Modules (3 files)</h3>

<p>This changeset updates the WorldPay Hosted Payment Pages module.</p>

<h4 class="notoc">Payment Modules</h4>

<h5 class="notoc">WorldPay Hosted Payment Pages</h5>

<p>Copy the following files and directories to their respective directories:</p>

<p>
  <i class="icon-file"></i> <strong>ext/modules/payment/rbsworldpay/hosted_callback.php</strong><br />
  <i class="icon-file"></i> <strong>includes/languages/english/modules/payment/rbsworldpay_hosted.php</strong><br />
  <i class="icon-file"></i> <strong>includes/modules/payment/rbsworldpay_hosted.php</strong>
</p>

<div class="note">Please also copy and update the language definition file to the other languages you have installed.</div>

<p>After the files have been copied, the modules can be installed from the Administration Tool -&gt; Modules -&gt; Payment -> Install page, or configured from the Administration Tool -> Modules -> Payment page if they were previously installed.</p>

<div class="note">It is important to review the module configuration paramters of modules that were previously installed to make sure new parameters have been configured properly.</div>

<div class="info">It is safe to overwrite existing files with the new version.</div>

<p class="pull-right"><a href="#upgtop"><i class="icon-circle-arrow-up"></i></a></p>
<p><a href="https://github.com/osCommerce/oscommerce2/commit/bf835e50fd0931cbd4130669a93b46e4c0fdc706" target="_blank">View online at GitHub</a></p>

<h2>Thank You!</h2>

<p>We'd like to thank the community for their feedback on our releases. In addition, we thank the following people who participated in the development of this release.</p>

<table class="pretty">
  <thead>
    <tr>
      <th>Bug Reporters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/303521-dculley/" target="_blank">dculley</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/241134-gergely/" target="_blank">Gergely</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/289095-mattjt83/" target="_blank">mattjt83</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/1830-whitehat/" target="_blank">wHiTeHaT</a></td>
    </tr>
  </tbody>
</table>

<table class="pretty">
  <thead>
    <tr>
      <th>Testers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/231701-altoid/" target="_blank">altoid</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/327952-artcoinc/" target="_blank">ArtcoInc</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/69-burt/" target="_blank">burt</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/3489-gyakutsuki/" target="_blank">Gyakutsuki</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/329128-hax8220/" target="_blank">hax8220</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/185951-joli1811/" target="_blank">joli1811</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/10653-tim-ver/" target="_blank">tim_ver</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/27491-tsimi/" target="_blank">Tsimi</a></td>
    </tr>
    <tr>
      <td><a href="http://forums.oscommerce.com/user/1830-whitehat/" target="_blank">wHiTeHaT</a></td>
    </tr>
  </tbody>
</table>

<h2>Reference</h2>

<p>A full list of source code changes can be seen at:</p>

<p><a href="https://github.com/osCommerce/oscommerce2/compare/v2.3.3.4...upgrade234" target="_blank">https://github.com/osCommerce/oscommerce2/compare/v2.3.3.4...upgrade234</a></p>
